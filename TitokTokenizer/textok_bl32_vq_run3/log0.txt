[32m[04/13 11:22:37 Tex-Tok]: [0mSaving config to textok_bl32_vq_run3/config.yaml
[32m[04/13 11:22:37 Tex-Tok]: [0mConfig:
experiment:
  project: textok_bl32_vq
  name: textok_bl32_vq_run3
  output_dir: textok_bl32_vq_run3
  max_train_examples: 685800000
  save_every: 50000
  eval_every: 50000
  generate_every: 5000
  log_every: 50
  log_grad_norm_every: 1000
  resume: true
  logging_dir: textok_bl32_vq_run3/logs
model:
  vq_model:
    quantize_mode: vq
    codebook_size: 8192
    token_size: 64
    use_l2_norm: false
    commitment_cost: 0.25
    clustering_vq: true
    vit_enc_model_size: base
    vit_dec_model_size: large
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 32
    finetune_decoder: false
    is_legacy: false
    text_embed_dim: 768
losses:
  discriminator_start: 200000
  quantizer_weight: 1.0
  discriminator_factor: 1.0
  discriminator_weight: 0.1
  perceptual_loss: lpips-convnext_s-1.0-0.1
  perceptual_weight: 1.1
  reconstruction_loss: l2
  reconstruction_weight: 1.0
  lecam_regularization_weight: 0.001
dataset:
  params:
    train_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-train-{000000..000160}.tar
    eval_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-val-{000000..000049}.tar
    num_workers_per_gpu: 12
    dataset_with_class_label: false
    dataset_with_text_label: true
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
    res_ratio_filtering: true
    normalize_mean:
    - 0.485
    - 0.456
    - 0.406
    normalize_std:
    - 0.229
    - 0.224
    - 0.225
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    discriminator_learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.999
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 16
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 650000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/TexTok/textok_bl32_vq.yaml

[32m[04/13 11:22:38 Tex-Tok]: [0mCreating model and loss module.
[32m[04/13 11:22:42 Tex-Tok]: [0m========================================================================================================================================================================================================
Layer (type:depth-idx)                             Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
========================================================================================================================================================================================================
Textok                                             [1, 3, 256, 256]          [1, 3, 256, 256]          24,576                      0.01%                   --                        --
â”œâ”€TexTokEncoder: 1-1                               --                        [1, 64, 1, 32]            222,720                     0.06%                   --                        --
â”‚    â””â”€Conv2d: 2-1                                 [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.15%                   [16, 16]                  151,191,552
â”‚    â””â”€Linear: 2-2                                 [1, 77, 768]              [1, 77, 768]              590,592                     0.15%                   --                        590,592
â”‚    â””â”€LayerNorm: 2-3                              [1, 366, 768]             [1, 366, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€ModuleList: 2-4                             --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-1            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-1                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-2           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-3                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-4                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-1                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-2                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-3                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-2            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-5                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-6           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-7                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-8                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-4                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-5                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-6                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-3            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-9                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-10          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-11                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-12                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-7                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-8                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-9                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-4            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-13                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-14          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-15                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-16                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-10                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-11                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-12                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-5            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-17                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-18          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-19                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-20                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-13                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-14                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-15                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-6            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-21                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-22          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-23                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-24                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-16                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-17                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-18                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-7            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-25                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-26          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-27                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-28                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-19                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-20                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-21                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-8            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-29                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-30          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-31                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-32                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-22                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-23                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-24                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-9            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-33                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-34          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-35                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-36                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-25                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-26                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-27                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-10           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-37                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-38          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-39                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-40                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-28                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-29                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-30                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-11           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-41                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-42          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-43                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-44                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-31                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-32                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-33                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-12           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-45                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-46          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-47                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-48                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-34                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-35                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-36                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â””â”€LayerNorm: 2-5                              [1, 32, 768]              [1, 32, 768]              1,536                       0.00%                   --                        1,536
â”‚    â””â”€Conv2d: 2-6                                 [1, 768, 32, 1]           [1, 64, 32, 1]            49,216                      0.01%                   [1, 1]                    1,574,912
â”œâ”€VectorQuantizer: 1-2                             [1, 64, 1, 32]            [1, 64, 1, 32]            --                             --                   --                        --
â”‚    â””â”€Embedding: 2-7                              [32]                      [32, 64]                  524,288                     0.13%                   --                        16,777,216
â”œâ”€TATiTokDecoder: 1-3                              [1, 64, 1, 32]            [1, 3, 256, 256]          376,832                     0.10%                   --                        --
â”‚    â””â”€Linear: 2-8                                 [1, 32, 64]               [1, 32, 1024]             66,560                      0.02%                   --                        66,560
â”‚    â””â”€Linear: 2-9                                 [1, 77, 768]              [1, 77, 1024]             787,456                     0.20%                   --                        787,456
â”‚    â””â”€LayerNorm: 2-10                             [1, 366, 1024]            [1, 366, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€ModuleList: 2-11                            --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-13           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-49                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-50          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-51                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-52                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-37                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-38                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-39                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-14           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-53                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-54          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-55                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-56                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-40                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-41                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-42                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-15           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-57                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-58          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-59                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-60                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-43                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-44                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-45                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-16           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-61                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-62          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-63                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-64                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-46                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-47                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-48                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-17           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-65                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-66          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-67                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-68                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-49                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-50                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-51                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-18           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-69                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-70          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-71                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-72                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-52                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-53                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-54                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-19           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-73                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-74          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-75                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-76                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-55                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-56                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-57                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-20           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-77                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-78          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-79                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-80                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-58                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-59                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-60                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-21           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-81                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-82          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-83                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-84                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-61                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-62                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-63                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-22           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-85                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-86          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-87                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-88                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-64                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-65                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-66                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-23           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-89                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-90          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-91                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-92                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-67                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-68                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-69                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-24           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-93                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-94          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-95                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-96                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-70                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-71                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-72                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-25           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-97                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-98          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-99                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-100                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-73                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-74                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-75                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-26           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-101                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-102         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-103                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-104                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-76                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-77                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-78                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-27           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-105                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-106         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-107                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-108                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-79                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-80                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-81                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-28           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-109                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-110         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-111                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-112                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-82                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-83                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-84                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-29           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-113                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-114         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-115                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-116                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-85                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-86                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-87                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-30           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-117                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-118         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-119                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-120                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-88                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-89                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-90                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-31           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-121                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-122         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-123                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-124                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-91                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-92                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-93                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-32           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-125                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-126         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-127                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-128                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-94                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-95                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-96                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-33           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-129                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-130         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-131                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-132                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-97                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-98                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-99                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-34           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-133                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-134         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-135                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-136                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-100                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-101                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-102                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-35           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-137                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-138         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-139                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-140                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-103                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-104                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-105                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-36           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-141                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-142         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-143                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-144                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-106                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-107                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-108                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â””â”€LayerNorm: 2-12                             [1, 256, 1024]            [1, 256, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€Sequential: 2-13                            [1, 1024, 16, 16]         [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-37                           [1, 1024, 16, 16]         [1, 768, 16, 16]          787,200                     0.20%                   [1, 1]                    201,523,200
â”‚    â”‚    â””â”€Rearrange: 3-38                        [1, 768, 16, 16]          [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â””â”€Conv2d: 2-14                                [1, 3, 256, 256]          [1, 3, 256, 256]          84                          0.00%                   [3, 3]                    5,505,024
========================================================================================================================================================================================================
Total params: 391,391,124
Trainable params: 391,391,124
Non-trainable params: 0
Total mult-adds (G): 94.90
========================================================================================================================================================================================================
Input size (MB): 1.02
Forward/backward pass size (MB): 706.26
Params size (MB): 1046.63
Estimated Total Size (MB): 1753.91
========================================================================================================================================================================================================
[32m[04/13 11:22:44 Tex-Tok]: [0mCreating optimizers.
[32m[04/13 11:22:44 Tex-Tok]: [0mCreating lr_schedulers.
[32m[04/13 11:22:44 Tex-Tok]: [0mCreating dataloaders.
[32m[04/13 11:22:44 Tex-Tok]: [0mCreating evaluator.
[32m[04/13 11:22:44 Tex-Tok]: [0mPreparing model, optimizer and dataloaders
[32m[04/13 11:22:44 Tex-Tok]: [0m***** Running training *****
[32m[04/13 11:22:44 Tex-Tok]: [0m  Num training steps = 650000
[32m[04/13 11:22:44 Tex-Tok]: [0m  Gradient Accumulation steps = 1
[32m[04/13 11:22:44 Tex-Tok]: [0m  Instantaneous batch size per gpu = 16
[32m[04/13 11:22:44 Tex-Tok]: [0m  Total train batch size (w. parallel, distributed & accumulation) = 32
[32m[04/13 11:22:44 Tex-Tok]: [0mAll globbed checkpoints are: []
[32m[04/13 11:22:44 Tex-Tok]: [0mTraining from scratch.
[32m[04/13 11:23:10 Tex-Tok]: [0mData (t): 0.0104, 36.59/s/gpu Batch (t): 0.4372 LR: 0.000001 Step: 50 Total Loss: 2.9171 Recon Loss: 1.7422 
[32m[04/13 11:23:32 Tex-Tok]: [0mData (t): 0.0105, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000001 Step: 100 Total Loss: 2.3476 Recon Loss: 1.3882 
[32m[04/13 11:23:54 Tex-Tok]: [0mData (t): 0.0106, 36.54/s/gpu Batch (t): 0.4378 LR: 0.000002 Step: 150 Total Loss: 2.4023 Recon Loss: 1.5783 
[32m[04/13 11:24:16 Tex-Tok]: [0mData (t): 0.0106, 30.04/s/gpu Batch (t): 0.5326 LR: 0.000002 Step: 200 Total Loss: 2.1646 Recon Loss: 1.3547 
[32m[04/13 11:24:38 Tex-Tok]: [0mData (t): 0.0108, 36.50/s/gpu Batch (t): 0.4383 LR: 0.000003 Step: 250 Total Loss: 2.2642 Recon Loss: 1.5170 
[32m[04/13 11:25:00 Tex-Tok]: [0mData (t): 0.0105, 36.57/s/gpu Batch (t): 0.4376 LR: 0.000003 Step: 300 Total Loss: 2.3312 Recon Loss: 1.5884 
[32m[04/13 11:25:22 Tex-Tok]: [0mData (t): 0.0105, 36.60/s/gpu Batch (t): 0.4371 LR: 0.000004 Step: 350 Total Loss: 2.2165 Recon Loss: 1.4519 
[32m[04/13 11:25:44 Tex-Tok]: [0mData (t): 0.0106, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000004 Step: 400 Total Loss: 2.0971 Recon Loss: 1.3664 
[32m[04/13 11:26:05 Tex-Tok]: [0mData (t): 0.0105, 36.62/s/gpu Batch (t): 0.4369 LR: 0.000005 Step: 450 Total Loss: 2.3671 Recon Loss: 1.6495 
[32m[04/13 11:26:27 Tex-Tok]: [0mData (t): 0.0106, 36.43/s/gpu Batch (t): 0.4392 LR: 0.000005 Step: 500 Total Loss: 2.5255 Recon Loss: 1.7741 
[32m[04/13 11:26:49 Tex-Tok]: [0mData (t): 0.0107, 36.43/s/gpu Batch (t): 0.4393 LR: 0.000006 Step: 550 Total Loss: 2.3605 Recon Loss: 1.6044 
[32m[04/13 11:27:11 Tex-Tok]: [0mData (t): 0.0105, 36.31/s/gpu Batch (t): 0.4406 LR: 0.000006 Step: 600 Total Loss: 2.2237 Recon Loss: 1.3961 
[32m[04/13 11:27:33 Tex-Tok]: [0mData (t): 0.0105, 36.48/s/gpu Batch (t): 0.4385 LR: 0.000007 Step: 650 Total Loss: 2.1785 Recon Loss: 1.4319 
[32m[04/13 11:27:55 Tex-Tok]: [0mData (t): 0.0105, 36.65/s/gpu Batch (t): 0.4366 LR: 0.000007 Step: 700 Total Loss: 1.9390 Recon Loss: 1.2043 
[32m[04/13 11:28:17 Tex-Tok]: [0mData (t): 0.0105, 36.50/s/gpu Batch (t): 0.4384 LR: 0.000008 Step: 750 Total Loss: 2.0960 Recon Loss: 1.3825 
[32m[04/13 11:28:39 Tex-Tok]: [0mData (t): 0.0106, 36.38/s/gpu Batch (t): 0.4397 LR: 0.000008 Step: 800 Total Loss: 1.8529 Recon Loss: 1.1032 
[32m[04/13 11:29:01 Tex-Tok]: [0mData (t): 0.0105, 36.50/s/gpu Batch (t): 0.4384 LR: 0.000009 Step: 850 Total Loss: 1.9380 Recon Loss: 1.1430 
[32m[04/13 11:29:23 Tex-Tok]: [0mData (t): 0.0106, 36.54/s/gpu Batch (t): 0.4379 LR: 0.000009 Step: 900 Total Loss: 2.3285 Recon Loss: 1.4565 
[32m[04/13 11:29:45 Tex-Tok]: [0mData (t): 0.0106, 36.43/s/gpu Batch (t): 0.4392 LR: 0.000010 Step: 950 Total Loss: 2.0877 Recon Loss: 1.2285 
[32m[04/13 11:30:07 Tex-Tok]: [0mData (t): 0.0105, 32.55/s/gpu Batch (t): 0.4915 LR: 0.000010 Step: 1000 Total Loss: 1.9805 Recon Loss: 1.1783 
[32m[04/13 11:30:29 Tex-Tok]: [0mData (t): 0.0107, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000010 Step: 1050 Total Loss: 2.1570 Recon Loss: 1.2986 
[32m[04/13 11:30:50 Tex-Tok]: [0mData (t): 0.0105, 36.54/s/gpu Batch (t): 0.4379 LR: 0.000011 Step: 1100 Total Loss: 2.1574 Recon Loss: 1.2859 
[32m[04/13 11:31:12 Tex-Tok]: [0mData (t): 0.0106, 35.60/s/gpu Batch (t): 0.4495 LR: 0.000012 Step: 1150 Total Loss: 1.7622 Recon Loss: 1.0393 
[32m[04/13 11:31:34 Tex-Tok]: [0mData (t): 0.0104, 36.39/s/gpu Batch (t): 0.4396 LR: 0.000012 Step: 1200 Total Loss: 1.9515 Recon Loss: 1.1699 
[32m[04/13 11:31:56 Tex-Tok]: [0mData (t): 0.0105, 36.66/s/gpu Batch (t): 0.4365 LR: 0.000013 Step: 1250 Total Loss: 2.0185 Recon Loss: 1.2850 
[32m[04/13 11:32:18 Tex-Tok]: [0mData (t): 0.0108, 36.46/s/gpu Batch (t): 0.4388 LR: 0.000013 Step: 1300 Total Loss: 1.8438 Recon Loss: 1.0628 
[32m[04/13 11:32:40 Tex-Tok]: [0mData (t): 0.0105, 36.52/s/gpu Batch (t): 0.4381 LR: 0.000014 Step: 1350 Total Loss: 1.7739 Recon Loss: 1.1064 
[32m[04/13 11:33:02 Tex-Tok]: [0mData (t): 0.0106, 36.33/s/gpu Batch (t): 0.4404 LR: 0.000014 Step: 1400 Total Loss: 1.8588 Recon Loss: 1.1574 
[32m[04/13 11:33:24 Tex-Tok]: [0mData (t): 0.0105, 36.33/s/gpu Batch (t): 0.4404 LR: 0.000015 Step: 1450 Total Loss: 1.9173 Recon Loss: 1.2117 
[32m[04/13 11:33:46 Tex-Tok]: [0mData (t): 0.0104, 36.49/s/gpu Batch (t): 0.4385 LR: 0.000015 Step: 1500 Total Loss: 1.8456 Recon Loss: 1.1347 
[32m[04/13 11:34:08 Tex-Tok]: [0mData (t): 0.0106, 36.40/s/gpu Batch (t): 0.4395 LR: 0.000016 Step: 1550 Total Loss: 1.9236 Recon Loss: 1.1976 
[32m[04/13 11:34:30 Tex-Tok]: [0mData (t): 0.0105, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000016 Step: 1600 Total Loss: 1.9352 Recon Loss: 1.1065 
[32m[04/13 11:34:51 Tex-Tok]: [0mData (t): 0.0106, 36.38/s/gpu Batch (t): 0.4398 LR: 0.000017 Step: 1650 Total Loss: 2.1522 Recon Loss: 1.2943 
[32m[04/13 11:35:13 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4375 LR: 0.000017 Step: 1700 Total Loss: 1.9953 Recon Loss: 1.1951 
[32m[04/13 11:35:35 Tex-Tok]: [0mData (t): 0.0104, 36.47/s/gpu Batch (t): 0.4387 LR: 0.000017 Step: 1750 Total Loss: 1.9991 Recon Loss: 1.1636 
[32m[04/13 11:35:57 Tex-Tok]: [0mData (t): 0.0106, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000018 Step: 1800 Total Loss: 1.9815 Recon Loss: 1.1052 
[32m[04/13 11:36:19 Tex-Tok]: [0mData (t): 0.0105, 36.55/s/gpu Batch (t): 0.4377 LR: 0.000018 Step: 1850 Total Loss: 1.8895 Recon Loss: 1.1641 
[32m[04/13 11:36:41 Tex-Tok]: [0mData (t): 0.0105, 36.60/s/gpu Batch (t): 0.4372 LR: 0.000019 Step: 1900 Total Loss: 1.8506 Recon Loss: 1.0948 
[32m[04/13 11:37:03 Tex-Tok]: [0mData (t): 0.0106, 36.51/s/gpu Batch (t): 0.4383 LR: 0.000020 Step: 1950 Total Loss: 1.8557 Recon Loss: 1.1164 
[32m[04/13 11:37:25 Tex-Tok]: [0mData (t): 0.0105, 34.48/s/gpu Batch (t): 0.4640 LR: 0.000020 Step: 2000 Total Loss: 1.9582 Recon Loss: 1.1501 
[32m[04/13 11:37:47 Tex-Tok]: [0mData (t): 0.0105, 36.41/s/gpu Batch (t): 0.4394 LR: 0.000020 Step: 2050 Total Loss: 1.7523 Recon Loss: 0.9896 
[32m[04/13 11:38:09 Tex-Tok]: [0mData (t): 0.0105, 36.41/s/gpu Batch (t): 0.4394 LR: 0.000021 Step: 2100 Total Loss: 2.0026 Recon Loss: 1.1897 
[32m[04/13 11:38:31 Tex-Tok]: [0mData (t): 0.0105, 36.41/s/gpu Batch (t): 0.4394 LR: 0.000021 Step: 2150 Total Loss: 1.9718 Recon Loss: 1.1307 
[32m[04/13 11:38:53 Tex-Tok]: [0mData (t): 0.0106, 36.53/s/gpu Batch (t): 0.4379 LR: 0.000022 Step: 2200 Total Loss: 1.8429 Recon Loss: 1.1224 
[32m[04/13 11:39:14 Tex-Tok]: [0mData (t): 0.0104, 36.56/s/gpu Batch (t): 0.4377 LR: 0.000022 Step: 2250 Total Loss: 1.9477 Recon Loss: 1.1486 
[32m[04/13 11:39:36 Tex-Tok]: [0mData (t): 0.0104, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000023 Step: 2300 Total Loss: 2.0317 Recon Loss: 1.2875 
[32m[04/13 11:39:58 Tex-Tok]: [0mData (t): 0.0104, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000023 Step: 2350 Total Loss: 2.1590 Recon Loss: 1.2628 
[32m[04/13 11:40:20 Tex-Tok]: [0mData (t): 0.0105, 36.51/s/gpu Batch (t): 0.4382 LR: 0.000024 Step: 2400 Total Loss: 2.0130 Recon Loss: 1.1413 
[32m[04/13 11:40:42 Tex-Tok]: [0mData (t): 0.0105, 36.59/s/gpu Batch (t): 0.4372 LR: 0.000024 Step: 2450 Total Loss: 1.9118 Recon Loss: 0.9483 
[32m[04/13 11:41:04 Tex-Tok]: [0mData (t): 0.0104, 36.55/s/gpu Batch (t): 0.4378 LR: 0.000025 Step: 2500 Total Loss: 1.7831 Recon Loss: 1.0197 
[32m[04/13 11:41:26 Tex-Tok]: [0mData (t): 0.0105, 36.49/s/gpu Batch (t): 0.4385 LR: 0.000025 Step: 2550 Total Loss: 1.6879 Recon Loss: 0.9896 
[32m[04/13 11:41:48 Tex-Tok]: [0mData (t): 0.0105, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000026 Step: 2600 Total Loss: 1.8410 Recon Loss: 1.0824 
[32m[04/13 11:42:10 Tex-Tok]: [0mData (t): 0.0105, 36.54/s/gpu Batch (t): 0.4379 LR: 0.000026 Step: 2650 Total Loss: 1.6572 Recon Loss: 0.9593 
[32m[04/13 11:42:32 Tex-Tok]: [0mData (t): 0.0104, 36.30/s/gpu Batch (t): 0.4408 LR: 0.000027 Step: 2700 Total Loss: 1.6976 Recon Loss: 0.9795 
[32m[04/13 11:42:54 Tex-Tok]: [0mData (t): 0.0105, 36.56/s/gpu Batch (t): 0.4376 LR: 0.000027 Step: 2750 Total Loss: 1.9652 Recon Loss: 1.1149 
[32m[04/13 11:43:16 Tex-Tok]: [0mData (t): 0.0118, 36.31/s/gpu Batch (t): 0.4406 LR: 0.000028 Step: 2800 Total Loss: 1.9608 Recon Loss: 1.0911 
[32m[04/13 11:43:38 Tex-Tok]: [0mData (t): 0.0107, 36.45/s/gpu Batch (t): 0.4389 LR: 0.000028 Step: 2850 Total Loss: 1.8267 Recon Loss: 1.0286 
[32m[04/13 11:43:59 Tex-Tok]: [0mData (t): 0.0104, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000029 Step: 2900 Total Loss: 1.6708 Recon Loss: 0.9834 
[32m[04/13 11:44:21 Tex-Tok]: [0mData (t): 0.0106, 36.15/s/gpu Batch (t): 0.4426 LR: 0.000029 Step: 2950 Total Loss: 1.9242 Recon Loss: 1.0508 
[32m[04/13 11:44:43 Tex-Tok]: [0mData (t): 0.0105, 34.72/s/gpu Batch (t): 0.4608 LR: 0.000030 Step: 3000 Total Loss: 1.8848 Recon Loss: 1.0708 
[32m[04/13 11:45:05 Tex-Tok]: [0mData (t): 0.0106, 36.29/s/gpu Batch (t): 0.4409 LR: 0.000030 Step: 3050 Total Loss: 1.9059 Recon Loss: 1.1007 
[32m[04/13 11:45:27 Tex-Tok]: [0mData (t): 0.0106, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000031 Step: 3100 Total Loss: 1.8125 Recon Loss: 0.9964 
[32m[04/13 11:45:49 Tex-Tok]: [0mData (t): 0.0108, 36.56/s/gpu Batch (t): 0.4377 LR: 0.000031 Step: 3150 Total Loss: 1.7037 Recon Loss: 0.8738 
[32m[04/13 11:46:11 Tex-Tok]: [0mData (t): 0.0105, 36.41/s/gpu Batch (t): 0.4394 LR: 0.000032 Step: 3200 Total Loss: 1.8592 Recon Loss: 1.0340 
[32m[04/13 11:46:33 Tex-Tok]: [0mData (t): 0.0105, 36.45/s/gpu Batch (t): 0.4390 LR: 0.000032 Step: 3250 Total Loss: 1.6536 Recon Loss: 0.9751 
[32m[04/13 11:46:55 Tex-Tok]: [0mData (t): 0.0105, 36.47/s/gpu Batch (t): 0.4387 LR: 0.000033 Step: 3300 Total Loss: 1.8052 Recon Loss: 0.9314 
[32m[04/13 11:47:17 Tex-Tok]: [0mData (t): 0.0106, 36.40/s/gpu Batch (t): 0.4396 LR: 0.000033 Step: 3350 Total Loss: 1.7580 Recon Loss: 1.0422 
[32m[04/13 11:47:39 Tex-Tok]: [0mData (t): 0.0103, 36.58/s/gpu Batch (t): 0.4373 LR: 0.000034 Step: 3400 Total Loss: 1.8808 Recon Loss: 1.1336 
[32m[04/13 11:48:01 Tex-Tok]: [0mData (t): 0.0105, 36.52/s/gpu Batch (t): 0.4381 LR: 0.000034 Step: 3450 Total Loss: 1.6702 Recon Loss: 0.9035 
[32m[04/13 11:48:23 Tex-Tok]: [0mData (t): 0.0105, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000035 Step: 3500 Total Loss: 1.7135 Recon Loss: 1.0385 
[32m[04/13 11:48:44 Tex-Tok]: [0mData (t): 0.0105, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000035 Step: 3550 Total Loss: 2.0225 Recon Loss: 1.1796 
[32m[04/13 11:49:06 Tex-Tok]: [0mData (t): 0.0106, 36.43/s/gpu Batch (t): 0.4392 LR: 0.000036 Step: 3600 Total Loss: 1.7080 Recon Loss: 0.9373 
[32m[04/13 11:49:28 Tex-Tok]: [0mData (t): 0.0105, 36.42/s/gpu Batch (t): 0.4394 LR: 0.000036 Step: 3650 Total Loss: 1.7127 Recon Loss: 0.8633 
[32m[04/13 11:49:50 Tex-Tok]: [0mData (t): 0.0107, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000037 Step: 3700 Total Loss: 1.7999 Recon Loss: 1.1021 
[32m[04/13 11:50:12 Tex-Tok]: [0mData (t): 0.0106, 36.52/s/gpu Batch (t): 0.4382 LR: 0.000037 Step: 3750 Total Loss: 1.9044 Recon Loss: 1.0659 
[32m[04/13 11:50:34 Tex-Tok]: [0mData (t): 0.0105, 36.47/s/gpu Batch (t): 0.4388 LR: 0.000038 Step: 3800 Total Loss: 1.7209 Recon Loss: 0.9892 
[32m[04/13 11:50:56 Tex-Tok]: [0mData (t): 0.0105, 36.45/s/gpu Batch (t): 0.4390 LR: 0.000038 Step: 3850 Total Loss: 1.8564 Recon Loss: 0.9647 
[32m[04/13 11:51:18 Tex-Tok]: [0mData (t): 0.0105, 36.55/s/gpu Batch (t): 0.4377 LR: 0.000039 Step: 3900 Total Loss: 1.6945 Recon Loss: 0.9618 
[32m[04/13 11:51:40 Tex-Tok]: [0mData (t): 0.0108, 36.41/s/gpu Batch (t): 0.4394 LR: 0.000039 Step: 3950 Total Loss: 1.8670 Recon Loss: 1.0261 
[32m[04/13 11:52:02 Tex-Tok]: [0mData (t): 0.0107, 34.40/s/gpu Batch (t): 0.4651 LR: 0.000040 Step: 4000 Total Loss: 1.6607 Recon Loss: 0.9864 
[32m[04/13 11:52:24 Tex-Tok]: [0mData (t): 0.0105, 36.55/s/gpu Batch (t): 0.4377 LR: 0.000040 Step: 4050 Total Loss: 1.6299 Recon Loss: 0.9485 
[32m[04/13 11:52:46 Tex-Tok]: [0mData (t): 0.0115, 36.61/s/gpu Batch (t): 0.4370 LR: 0.000041 Step: 4100 Total Loss: 1.9200 Recon Loss: 1.1045 
[32m[04/13 11:53:07 Tex-Tok]: [0mData (t): 0.0104, 36.56/s/gpu Batch (t): 0.4377 LR: 0.000041 Step: 4150 Total Loss: 1.6445 Recon Loss: 0.9202 
[32m[04/13 11:53:29 Tex-Tok]: [0mData (t): 0.0105, 36.55/s/gpu Batch (t): 0.4378 LR: 0.000042 Step: 4200 Total Loss: 1.7773 Recon Loss: 0.9931 
[32m[04/13 11:53:51 Tex-Tok]: [0mData (t): 0.0106, 36.37/s/gpu Batch (t): 0.4400 LR: 0.000042 Step: 4250 Total Loss: 1.7094 Recon Loss: 1.0343 
[32m[04/13 11:54:13 Tex-Tok]: [0mData (t): 0.0107, 36.39/s/gpu Batch (t): 0.4397 LR: 0.000043 Step: 4300 Total Loss: 2.0031 Recon Loss: 1.1249 
[32m[04/13 11:54:35 Tex-Tok]: [0mData (t): 0.0105, 36.42/s/gpu Batch (t): 0.4393 LR: 0.000043 Step: 4350 Total Loss: 1.9640 Recon Loss: 1.0874 
[32m[04/13 11:54:57 Tex-Tok]: [0mData (t): 0.0106, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000044 Step: 4400 Total Loss: 1.7522 Recon Loss: 0.9892 
[32m[04/13 11:55:19 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000044 Step: 4450 Total Loss: 1.6887 Recon Loss: 0.8657 
[32m[04/13 11:55:41 Tex-Tok]: [0mData (t): 0.0105, 36.60/s/gpu Batch (t): 0.4371 LR: 0.000045 Step: 4500 Total Loss: 1.7571 Recon Loss: 1.0148 
[32m[04/13 11:56:03 Tex-Tok]: [0mData (t): 0.0107, 36.37/s/gpu Batch (t): 0.4399 LR: 0.000045 Step: 4550 Total Loss: 1.8060 Recon Loss: 0.9911 
[32m[04/13 11:56:25 Tex-Tok]: [0mData (t): 0.0107, 36.31/s/gpu Batch (t): 0.4406 LR: 0.000046 Step: 4600 Total Loss: 1.7941 Recon Loss: 0.9541 
[32m[04/13 11:56:47 Tex-Tok]: [0mData (t): 0.0105, 36.47/s/gpu Batch (t): 0.4387 LR: 0.000046 Step: 4650 Total Loss: 1.7408 Recon Loss: 1.0423 
[32m[04/13 11:57:09 Tex-Tok]: [0mData (t): 0.0107, 36.26/s/gpu Batch (t): 0.4412 LR: 0.000047 Step: 4700 Total Loss: 1.7630 Recon Loss: 1.1090 
[32m[04/13 11:57:31 Tex-Tok]: [0mData (t): 0.0104, 36.33/s/gpu Batch (t): 0.4404 LR: 0.000047 Step: 4750 Total Loss: 1.7237 Recon Loss: 0.9370 
[32m[04/13 11:57:52 Tex-Tok]: [0mData (t): 0.0106, 36.47/s/gpu Batch (t): 0.4388 LR: 0.000048 Step: 4800 Total Loss: 1.6138 Recon Loss: 0.9008 
[32m[04/13 11:58:14 Tex-Tok]: [0mData (t): 0.0106, 36.46/s/gpu Batch (t): 0.4388 LR: 0.000048 Step: 4850 Total Loss: 1.7697 Recon Loss: 0.9907 
[32m[04/13 11:58:36 Tex-Tok]: [0mData (t): 0.0104, 36.41/s/gpu Batch (t): 0.4394 LR: 0.000049 Step: 4900 Total Loss: 1.5304 Recon Loss: 0.8155 
[32m[04/13 11:58:58 Tex-Tok]: [0mData (t): 0.0104, 36.64/s/gpu Batch (t): 0.4367 LR: 0.000049 Step: 4950 Total Loss: 1.8361 Recon Loss: 0.9508 
[32m[04/13 11:59:20 Tex-Tok]: [0mData (t): 0.0106, 34.66/s/gpu Batch (t): 0.4617 LR: 0.000050 Step: 5000 Total Loss: 1.6367 Recon Loss: 0.8648 
[32m[04/13 11:59:21 Tex-Tok]: [0mReconstructing images...
[32m[04/13 12:36:08 Tex-Tok]: [0mSaving config to textok_bl32_vq_run3/config.yaml
[32m[04/13 12:36:08 Tex-Tok]: [0mConfig:
experiment:
  project: textok_bl32_vq
  name: textok_bl32_vq_run3
  output_dir: textok_bl32_vq_run3
  max_train_examples: 685800000
  save_every: 50000
  eval_every: 50000
  generate_every: 500
  log_every: 50
  log_grad_norm_every: 1000
  resume: true
  logging_dir: textok_bl32_vq_run3/logs
model:
  vq_model:
    quantize_mode: vq
    codebook_size: 8192
    token_size: 64
    use_l2_norm: false
    commitment_cost: 0.25
    clustering_vq: true
    vit_enc_model_size: base
    vit_dec_model_size: large
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 32
    finetune_decoder: false
    is_legacy: false
    text_embed_dim: 768
losses:
  discriminator_start: 200000
  quantizer_weight: 1.0
  discriminator_factor: 1.0
  discriminator_weight: 0.1
  perceptual_loss: lpips-convnext_s-1.0-0.1
  perceptual_weight: 1.1
  reconstruction_loss: l2
  reconstruction_weight: 1.0
  lecam_regularization_weight: 0.001
dataset:
  params:
    train_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-train-{000000..000160}.tar
    eval_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-val-{000000..000049}.tar
    num_workers_per_gpu: 12
    dataset_with_class_label: false
    dataset_with_text_label: true
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
    res_ratio_filtering: true
    normalize_mean:
    - 0.485
    - 0.456
    - 0.406
    normalize_std:
    - 0.229
    - 0.224
    - 0.225
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    discriminator_learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.999
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 16
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 650000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/TexTok/textok_bl32_vq.yaml

[32m[04/13 12:36:08 Tex-Tok]: [0mCreating model and loss module.
[32m[04/13 12:36:13 Tex-Tok]: [0m========================================================================================================================================================================================================
Layer (type:depth-idx)                             Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
========================================================================================================================================================================================================
Textok                                             [1, 3, 256, 256]          [1, 3, 256, 256]          24,576                      0.01%                   --                        --
â”œâ”€TexTokEncoder: 1-1                               --                        [1, 64, 1, 32]            222,720                     0.06%                   --                        --
â”‚    â””â”€Conv2d: 2-1                                 [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.15%                   [16, 16]                  151,191,552
â”‚    â””â”€Linear: 2-2                                 [1, 77, 768]              [1, 77, 768]              590,592                     0.15%                   --                        590,592
â”‚    â””â”€LayerNorm: 2-3                              [1, 366, 768]             [1, 366, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€ModuleList: 2-4                             --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-1            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-1                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-2           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-3                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-4                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-1                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-2                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-3                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-2            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-5                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-6           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-7                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-8                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-4                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-5                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-6                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-3            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-9                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-10          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-11                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-12                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-7                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-8                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-9                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-4            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-13                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-14          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-15                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-16                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-10                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-11                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-12                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-5            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-17                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-18          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-19                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-20                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-13                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-14                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-15                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-6            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-21                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-22          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-23                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-24                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-16                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-17                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-18                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-7            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-25                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-26          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-27                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-28                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-19                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-20                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-21                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-8            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-29                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-30          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-31                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-32                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-22                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-23                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-24                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-9            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-33                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-34          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-35                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-36                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-25                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-26                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-27                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-10           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-37                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-38          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-39                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-40                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-28                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-29                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-30                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-11           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-41                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-42          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-43                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-44                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-31                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-32                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-33                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-12           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-45                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-46          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-47                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-48                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-34                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-35                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-36                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â””â”€LayerNorm: 2-5                              [1, 32, 768]              [1, 32, 768]              1,536                       0.00%                   --                        1,536
â”‚    â””â”€Conv2d: 2-6                                 [1, 768, 32, 1]           [1, 64, 32, 1]            49,216                      0.01%                   [1, 1]                    1,574,912
â”œâ”€VectorQuantizer: 1-2                             [1, 64, 1, 32]            [1, 64, 1, 32]            --                             --                   --                        --
â”‚    â””â”€Embedding: 2-7                              [32]                      [32, 64]                  524,288                     0.13%                   --                        16,777,216
â”œâ”€TATiTokDecoder: 1-3                              [1, 64, 1, 32]            [1, 3, 256, 256]          376,832                     0.10%                   --                        --
â”‚    â””â”€Linear: 2-8                                 [1, 32, 64]               [1, 32, 1024]             66,560                      0.02%                   --                        66,560
â”‚    â””â”€Linear: 2-9                                 [1, 77, 768]              [1, 77, 1024]             787,456                     0.20%                   --                        787,456
â”‚    â””â”€LayerNorm: 2-10                             [1, 366, 1024]            [1, 366, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€ModuleList: 2-11                            --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-13           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-49                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-50          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-51                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-52                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-37                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-38                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-39                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-14           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-53                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-54          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-55                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-56                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-40                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-41                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-42                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-15           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-57                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-58          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-59                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-60                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-43                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-44                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-45                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-16           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-61                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-62          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-63                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-64                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-46                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-47                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-48                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-17           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-65                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-66          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-67                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-68                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-49                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-50                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-51                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-18           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-69                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-70          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-71                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-72                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-52                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-53                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-54                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-19           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-73                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-74          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-75                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-76                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-55                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-56                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-57                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-20           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-77                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-78          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-79                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-80                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-58                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-59                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-60                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-21           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-81                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-82          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-83                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-84                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-61                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-62                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-63                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-22           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-85                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-86          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-87                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-88                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-64                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-65                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-66                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-23           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-89                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-90          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-91                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-92                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-67                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-68                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-69                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-24           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-93                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-94          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-95                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-96                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-70                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-71                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-72                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-25           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-97                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-98          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-99                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-100                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-73                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-74                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-75                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-26           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-101                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-102         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-103                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-104                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-76                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-77                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-78                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-27           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-105                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-106         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-107                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-108                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-79                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-80                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-81                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-28           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-109                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-110         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-111                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-112                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-82                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-83                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-84                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-29           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-113                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-114         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-115                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-116                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-85                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-86                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-87                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-30           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-117                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-118         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-119                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-120                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-88                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-89                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-90                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-31           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-121                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-122         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-123                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-124                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-91                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-92                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-93                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-32           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-125                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-126         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-127                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-128                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-94                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-95                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-96                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-33           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-129                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-130         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-131                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-132                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-97                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-98                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-99                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-34           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-133                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-134         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-135                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-136                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-100                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-101                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-102                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-35           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-137                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-138         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-139                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-140                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-103                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-104                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-105                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-36           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-141                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-142         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-143                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-144                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-106                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-107                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-108                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â””â”€LayerNorm: 2-12                             [1, 256, 1024]            [1, 256, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€Sequential: 2-13                            [1, 1024, 16, 16]         [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-37                           [1, 1024, 16, 16]         [1, 768, 16, 16]          787,200                     0.20%                   [1, 1]                    201,523,200
â”‚    â”‚    â””â”€Rearrange: 3-38                        [1, 768, 16, 16]          [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â””â”€Conv2d: 2-14                                [1, 3, 256, 256]          [1, 3, 256, 256]          84                          0.00%                   [3, 3]                    5,505,024
========================================================================================================================================================================================================
Total params: 391,391,124
Trainable params: 391,391,124
Non-trainable params: 0
Total mult-adds (G): 94.90
========================================================================================================================================================================================================
Input size (MB): 1.02
Forward/backward pass size (MB): 706.26
Params size (MB): 1046.63
Estimated Total Size (MB): 1753.91
========================================================================================================================================================================================================
[32m[04/13 12:36:15 Tex-Tok]: [0mCreating optimizers.
[32m[04/13 12:36:15 Tex-Tok]: [0mCreating lr_schedulers.
[32m[04/13 12:36:15 Tex-Tok]: [0mCreating dataloaders.
[32m[04/13 12:36:15 Tex-Tok]: [0mCreating evaluator.
[32m[04/13 12:36:15 Tex-Tok]: [0mPreparing model, optimizer and dataloaders
[32m[04/13 12:36:16 Tex-Tok]: [0m***** Running training *****
[32m[04/13 12:36:16 Tex-Tok]: [0m  Num training steps = 650000
[32m[04/13 12:36:16 Tex-Tok]: [0m  Gradient Accumulation steps = 1
[32m[04/13 12:36:16 Tex-Tok]: [0m  Instantaneous batch size per gpu = 16
[32m[04/13 12:36:16 Tex-Tok]: [0m  Total train batch size (w. parallel, distributed & accumulation) = 32
[32m[04/13 12:36:16 Tex-Tok]: [0mAll globbed checkpoints are: []
[32m[04/13 12:36:16 Tex-Tok]: [0mTraining from scratch.
[32m[04/13 12:36:42 Tex-Tok]: [0mData (t): 0.0106, 36.60/s/gpu Batch (t): 0.4372 LR: 0.000001 Step: 50 Total Loss: 2.8393 Recon Loss: 1.6297 
[32m[04/13 12:37:04 Tex-Tok]: [0mData (t): 0.0105, 36.66/s/gpu Batch (t): 0.4365 LR: 0.000001 Step: 100 Total Loss: 2.6089 Recon Loss: 1.6570 
[32m[04/13 12:37:26 Tex-Tok]: [0mData (t): 0.0105, 36.68/s/gpu Batch (t): 0.4362 LR: 0.000002 Step: 150 Total Loss: 2.3536 Recon Loss: 1.4931 
[32m[04/13 12:37:47 Tex-Tok]: [0mData (t): 0.0104, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000002 Step: 200 Total Loss: 2.0267 Recon Loss: 1.2579 
[32m[04/13 12:38:09 Tex-Tok]: [0mData (t): 0.0105, 36.50/s/gpu Batch (t): 0.4383 LR: 0.000003 Step: 250 Total Loss: 2.4721 Recon Loss: 1.7133 
[32m[04/13 12:38:31 Tex-Tok]: [0mData (t): 0.0105, 36.54/s/gpu Batch (t): 0.4379 LR: 0.000003 Step: 300 Total Loss: 2.5860 Recon Loss: 1.8199 
[32m[04/13 12:38:53 Tex-Tok]: [0mData (t): 0.0106, 36.39/s/gpu Batch (t): 0.4397 LR: 0.000004 Step: 350 Total Loss: 2.1751 Recon Loss: 1.4406 
[32m[04/13 12:39:15 Tex-Tok]: [0mData (t): 0.0104, 36.65/s/gpu Batch (t): 0.4365 LR: 0.000004 Step: 400 Total Loss: 2.1743 Recon Loss: 1.4374 
[32m[04/13 12:39:37 Tex-Tok]: [0mData (t): 0.0107, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000005 Step: 450 Total Loss: 2.2892 Recon Loss: 1.5149 
[32m[04/13 12:39:59 Tex-Tok]: [0mData (t): 0.0104, 36.52/s/gpu Batch (t): 0.4381 LR: 0.000005 Step: 500 Total Loss: 2.1727 Recon Loss: 1.4289 
[32m[04/13 12:39:59 Tex-Tok]: [0mReconstructing images...
[32m[04/13 14:38:22 Tex-Tok]: [0mSaving config to textok_bl32_vq_run3/config.yaml
[32m[04/13 14:38:22 Tex-Tok]: [0mConfig:
experiment:
  project: textok_bl32_vq
  name: textok_bl32_vq_run3
  output_dir: textok_bl32_vq_run3
  max_train_examples: 685800000
  save_every: 50000
  eval_every: 50000
  generate_every: 500
  log_every: 50
  log_grad_norm_every: 1000
  resume: true
  logging_dir: textok_bl32_vq_run3/logs
model:
  vq_model:
    quantize_mode: vq
    codebook_size: 8192
    token_size: 64
    use_l2_norm: false
    commitment_cost: 0.25
    clustering_vq: true
    vit_enc_model_size: base
    vit_dec_model_size: large
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 32
    finetune_decoder: false
    is_legacy: false
    text_embed_dim: 768
losses:
  discriminator_start: 200000
  quantizer_weight: 1.0
  discriminator_factor: 1.0
  discriminator_weight: 0.1
  perceptual_loss: lpips-convnext_s-1.0-0.1
  perceptual_weight: 1.1
  reconstruction_loss: l2
  reconstruction_weight: 1.0
  lecam_regularization_weight: 0.001
dataset:
  params:
    train_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-train-{000000..000160}.tar
    eval_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-val-{000000..000049}.tar
    num_workers_per_gpu: 12
    dataset_with_class_label: false
    dataset_with_text_label: true
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
    res_ratio_filtering: true
    normalize_mean:
    - 0.485
    - 0.456
    - 0.406
    normalize_std:
    - 0.229
    - 0.224
    - 0.225
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    discriminator_learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.999
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 16
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 650000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/TexTok/textok_bl32_vq.yaml

[32m[04/13 14:38:22 Tex-Tok]: [0mCreating model and loss module.
[32m[04/13 14:38:26 Tex-Tok]: [0m========================================================================================================================================================================================================
Layer (type:depth-idx)                             Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
========================================================================================================================================================================================================
Textok                                             [1, 3, 256, 256]          [1, 3, 256, 256]          24,576                      0.01%                   --                        --
â”œâ”€TexTokEncoder: 1-1                               --                        [1, 64, 1, 32]            222,720                     0.06%                   --                        --
â”‚    â””â”€Conv2d: 2-1                                 [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.15%                   [16, 16]                  151,191,552
â”‚    â””â”€Linear: 2-2                                 [1, 77, 768]              [1, 77, 768]              590,592                     0.15%                   --                        590,592
â”‚    â””â”€LayerNorm: 2-3                              [1, 366, 768]             [1, 366, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€ModuleList: 2-4                             --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-1            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-1                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-2           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-3                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-4                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-1                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-2                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-3                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-2            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-5                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-6           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-7                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-8                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-4                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-5                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-6                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-3            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-9                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-10          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-11                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-12                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-7                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-8                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-9                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-4            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-13                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-14          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-15                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-16                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-10                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-11                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-12                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-5            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-17                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-18          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-19                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-20                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-13                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-14                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-15                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-6            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-21                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-22          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-23                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-24                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-16                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-17                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-18                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-7            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-25                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-26          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-27                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-28                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-19                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-20                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-21                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-8            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-29                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-30          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-31                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-32                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-22                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-23                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-24                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-9            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-33                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-34          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-35                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-36                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-25                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-26                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-27                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-10           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-37                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-38          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-39                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-40                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-28                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-29                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-30                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-11           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-41                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-42          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-43                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-44                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-31                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-32                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-33                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-12           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-45                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-46          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-47                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-48                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-34                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-35                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-36                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â””â”€LayerNorm: 2-5                              [1, 32, 768]              [1, 32, 768]              1,536                       0.00%                   --                        1,536
â”‚    â””â”€Conv2d: 2-6                                 [1, 768, 32, 1]           [1, 64, 32, 1]            49,216                      0.01%                   [1, 1]                    1,574,912
â”œâ”€VectorQuantizer: 1-2                             [1, 64, 1, 32]            [1, 64, 1, 32]            --                             --                   --                        --
â”‚    â””â”€Embedding: 2-7                              [32]                      [32, 64]                  524,288                     0.13%                   --                        16,777,216
â”œâ”€TATiTokDecoder: 1-3                              [1, 64, 1, 32]            [1, 3, 256, 256]          376,832                     0.10%                   --                        --
â”‚    â””â”€Linear: 2-8                                 [1, 32, 64]               [1, 32, 1024]             66,560                      0.02%                   --                        66,560
â”‚    â””â”€Linear: 2-9                                 [1, 77, 768]              [1, 77, 1024]             787,456                     0.20%                   --                        787,456
â”‚    â””â”€LayerNorm: 2-10                             [1, 366, 1024]            [1, 366, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€ModuleList: 2-11                            --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-13           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-49                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-50          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-51                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-52                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-37                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-38                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-39                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-14           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-53                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-54          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-55                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-56                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-40                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-41                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-42                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-15           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-57                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-58          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-59                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-60                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-43                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-44                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-45                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-16           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-61                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-62          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-63                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-64                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-46                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-47                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-48                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-17           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-65                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-66          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-67                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-68                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-49                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-50                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-51                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-18           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-69                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-70          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-71                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-72                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-52                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-53                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-54                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-19           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-73                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-74          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-75                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-76                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-55                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-56                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-57                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-20           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-77                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-78          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-79                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-80                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-58                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-59                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-60                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-21           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-81                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-82          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-83                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-84                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-61                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-62                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-63                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-22           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-85                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-86          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-87                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-88                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-64                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-65                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-66                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-23           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-89                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-90          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-91                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-92                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-67                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-68                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-69                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-24           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-93                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-94          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-95                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-96                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-70                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-71                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-72                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-25           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-97                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-98          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-99                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-100                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-73                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-74                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-75                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-26           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-101                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-102         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-103                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-104                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-76                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-77                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-78                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-27           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-105                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-106         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-107                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-108                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-79                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-80                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-81                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-28           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-109                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-110         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-111                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-112                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-82                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-83                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-84                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-29           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-113                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-114         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-115                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-116                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-85                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-86                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-87                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-30           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-117                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-118         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-119                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-120                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-88                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-89                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-90                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-31           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-121                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-122         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-123                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-124                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-91                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-92                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-93                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-32           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-125                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-126         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-127                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-128                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-94                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-95                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-96                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-33           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-129                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-130         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-131                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-132                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-97                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-98                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-99                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-34           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-133                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-134         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-135                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-136                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-100                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-101                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-102                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-35           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-137                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-138         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-139                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-140                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-103                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-104                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-105                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-36           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-141                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-142         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-143                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-144                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-106                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-107                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-108                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â””â”€LayerNorm: 2-12                             [1, 256, 1024]            [1, 256, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€Sequential: 2-13                            [1, 1024, 16, 16]         [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-37                           [1, 1024, 16, 16]         [1, 768, 16, 16]          787,200                     0.20%                   [1, 1]                    201,523,200
â”‚    â”‚    â””â”€Rearrange: 3-38                        [1, 768, 16, 16]          [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â””â”€Conv2d: 2-14                                [1, 3, 256, 256]          [1, 3, 256, 256]          84                          0.00%                   [3, 3]                    5,505,024
========================================================================================================================================================================================================
Total params: 391,391,124
Trainable params: 391,391,124
Non-trainable params: 0
Total mult-adds (G): 94.90
========================================================================================================================================================================================================
Input size (MB): 1.02
Forward/backward pass size (MB): 706.26
Params size (MB): 1046.63
Estimated Total Size (MB): 1753.91
========================================================================================================================================================================================================
[32m[04/13 14:38:28 Tex-Tok]: [0mCreating optimizers.
[32m[04/13 14:38:28 Tex-Tok]: [0mCreating lr_schedulers.
[32m[04/13 14:38:28 Tex-Tok]: [0mCreating dataloaders.
[32m[04/13 14:38:28 Tex-Tok]: [0mCreating evaluator.
[32m[04/13 14:38:28 Tex-Tok]: [0mPreparing model, optimizer and dataloaders
[32m[04/13 14:38:29 Tex-Tok]: [0m***** Running training *****
[32m[04/13 14:38:29 Tex-Tok]: [0m  Num training steps = 650000
[32m[04/13 14:38:29 Tex-Tok]: [0m  Gradient Accumulation steps = 1
[32m[04/13 14:38:29 Tex-Tok]: [0m  Instantaneous batch size per gpu = 16
[32m[04/13 14:38:29 Tex-Tok]: [0m  Total train batch size (w. parallel, distributed & accumulation) = 32
[32m[04/13 14:38:29 Tex-Tok]: [0mAll globbed checkpoints are: []
[32m[04/13 14:38:29 Tex-Tok]: [0mTraining from scratch.
[32m[04/13 14:38:55 Tex-Tok]: [0mData (t): 0.0105, 36.60/s/gpu Batch (t): 0.4371 LR: 0.000001 Step: 50 Total Loss: 2.5853 Recon Loss: 1.3655 
[32m[04/13 14:39:17 Tex-Tok]: [0mData (t): 0.0105, 36.62/s/gpu Batch (t): 0.4370 LR: 0.000001 Step: 100 Total Loss: 2.7272 Recon Loss: 1.7564 
[32m[04/13 14:39:38 Tex-Tok]: [0mData (t): 0.0105, 36.63/s/gpu Batch (t): 0.4368 LR: 0.000002 Step: 150 Total Loss: 2.5952 Recon Loss: 1.7449 
[32m[04/13 14:40:00 Tex-Tok]: [0mData (t): 0.0106, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000002 Step: 200 Total Loss: 2.2565 Recon Loss: 1.4787 
[32m[04/13 14:40:22 Tex-Tok]: [0mData (t): 0.0105, 36.47/s/gpu Batch (t): 0.4387 LR: 0.000003 Step: 250 Total Loss: 2.4705 Recon Loss: 1.7108 
[32m[04/13 14:40:44 Tex-Tok]: [0mData (t): 0.0105, 36.32/s/gpu Batch (t): 0.4406 LR: 0.000003 Step: 300 Total Loss: 2.1427 Recon Loss: 1.3747 
[32m[04/13 14:41:06 Tex-Tok]: [0mData (t): 0.0106, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000004 Step: 350 Total Loss: 2.0424 Recon Loss: 1.2906 
[32m[04/13 14:41:28 Tex-Tok]: [0mData (t): 0.0105, 36.62/s/gpu Batch (t): 0.4370 LR: 0.000004 Step: 400 Total Loss: 2.0643 Recon Loss: 1.3219 
[32m[04/13 14:41:50 Tex-Tok]: [0mData (t): 0.0105, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000005 Step: 450 Total Loss: 2.6618 Recon Loss: 1.9130 
[32m[04/13 14:42:12 Tex-Tok]: [0mData (t): 0.0105, 36.67/s/gpu Batch (t): 0.4363 LR: 0.000005 Step: 500 Total Loss: 2.2910 Recon Loss: 1.5385 
[32m[04/13 14:42:12 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:06:31 Tex-Tok]: [0mSaving config to textok_bl32_vq_run3/config.yaml
[32m[04/13 15:06:31 Tex-Tok]: [0mConfig:
experiment:
  project: textok_bl32_vq
  name: textok_bl32_vq_run3
  output_dir: textok_bl32_vq_run3
  max_train_examples: 685800000
  save_every: 50000
  eval_every: 50000
  generate_every: 500
  log_every: 50
  log_grad_norm_every: 1000
  resume: true
  logging_dir: textok_bl32_vq_run3/logs
model:
  vq_model:
    quantize_mode: vq
    codebook_size: 8192
    token_size: 64
    use_l2_norm: false
    commitment_cost: 0.25
    clustering_vq: true
    vit_enc_model_size: base
    vit_dec_model_size: large
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 32
    finetune_decoder: false
    is_legacy: false
    text_embed_dim: 768
losses:
  discriminator_start: 200000
  quantizer_weight: 1.0
  discriminator_factor: 1.0
  discriminator_weight: 0.1
  perceptual_loss: lpips-convnext_s-1.0-0.1
  perceptual_weight: 1.1
  reconstruction_loss: l2
  reconstruction_weight: 1.0
  lecam_regularization_weight: 0.001
dataset:
  params:
    train_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-train-{000000..000160}.tar
    eval_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-val-{000000..000049}.tar
    num_workers_per_gpu: 12
    dataset_with_class_label: false
    dataset_with_text_label: true
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
    res_ratio_filtering: true
    normalize_mean:
    - 0.485
    - 0.456
    - 0.406
    normalize_std:
    - 0.229
    - 0.224
    - 0.225
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    discriminator_learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.999
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 16
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 650000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/TexTok/textok_bl32_vq.yaml

[32m[04/13 15:06:32 Tex-Tok]: [0mCreating model and loss module.
[32m[04/13 15:06:36 Tex-Tok]: [0m========================================================================================================================================================================================================
Layer (type:depth-idx)                             Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
========================================================================================================================================================================================================
Textok                                             [1, 3, 256, 256]          [1, 3, 256, 256]          24,576                      0.01%                   --                        --
â”œâ”€TexTokEncoder: 1-1                               --                        [1, 64, 1, 32]            222,720                     0.06%                   --                        --
â”‚    â””â”€Conv2d: 2-1                                 [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.15%                   [16, 16]                  151,191,552
â”‚    â””â”€Linear: 2-2                                 [1, 77, 768]              [1, 77, 768]              590,592                     0.15%                   --                        590,592
â”‚    â””â”€LayerNorm: 2-3                              [1, 366, 768]             [1, 366, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€ModuleList: 2-4                             --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-1            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-1                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-2           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-3                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-4                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-1                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-2                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-3                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-2            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-5                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-6           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-7                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-8                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-4                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-5                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-6                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-3            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-9                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-10          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-11                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-12                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-7                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-8                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-9                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-4            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-13                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-14          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-15                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-16                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-10                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-11                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-12                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-5            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-17                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-18          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-19                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-20                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-13                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-14                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-15                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-6            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-21                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-22          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-23                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-24                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-16                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-17                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-18                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-7            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-25                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-26          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-27                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-28                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-19                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-20                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-21                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-8            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-29                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-30          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-31                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-32                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-22                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-23                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-24                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-9            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-33                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-34          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-35                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-36                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-25                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-26                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-27                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-10           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-37                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-38          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-39                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-40                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-28                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-29                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-30                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-11           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-41                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-42          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-43                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-44                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-31                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-32                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-33                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-12           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-45                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-46          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-47                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-48                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-34                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-35                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-36                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â””â”€LayerNorm: 2-5                              [1, 32, 768]              [1, 32, 768]              1,536                       0.00%                   --                        1,536
â”‚    â””â”€Conv2d: 2-6                                 [1, 768, 32, 1]           [1, 64, 32, 1]            49,216                      0.01%                   [1, 1]                    1,574,912
â”œâ”€VectorQuantizer: 1-2                             [1, 64, 1, 32]            [1, 64, 1, 32]            --                             --                   --                        --
â”‚    â””â”€Embedding: 2-7                              [32]                      [32, 64]                  524,288                     0.13%                   --                        16,777,216
â”œâ”€TATiTokDecoder: 1-3                              [1, 64, 1, 32]            [1, 3, 256, 256]          376,832                     0.10%                   --                        --
â”‚    â””â”€Linear: 2-8                                 [1, 32, 64]               [1, 32, 1024]             66,560                      0.02%                   --                        66,560
â”‚    â””â”€Linear: 2-9                                 [1, 77, 768]              [1, 77, 1024]             787,456                     0.20%                   --                        787,456
â”‚    â””â”€LayerNorm: 2-10                             [1, 366, 1024]            [1, 366, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€ModuleList: 2-11                            --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-13           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-49                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-50          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-51                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-52                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-37                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-38                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-39                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-14           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-53                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-54          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-55                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-56                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-40                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-41                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-42                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-15           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-57                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-58          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-59                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-60                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-43                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-44                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-45                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-16           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-61                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-62          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-63                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-64                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-46                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-47                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-48                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-17           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-65                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-66          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-67                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-68                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-49                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-50                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-51                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-18           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-69                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-70          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-71                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-72                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-52                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-53                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-54                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-19           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-73                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-74          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-75                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-76                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-55                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-56                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-57                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-20           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-77                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-78          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-79                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-80                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-58                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-59                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-60                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-21           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-81                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-82          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-83                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-84                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-61                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-62                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-63                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-22           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-85                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-86          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-87                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-88                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-64                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-65                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-66                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-23           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-89                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-90          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-91                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-92                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-67                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-68                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-69                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-24           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-93                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-94          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-95                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-96                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-70                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-71                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-72                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-25           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-97                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-98          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-99                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-100                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-73                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-74                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-75                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-26           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-101                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-102         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-103                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-104                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-76                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-77                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-78                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-27           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-105                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-106         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-107                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-108                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-79                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-80                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-81                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-28           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-109                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-110         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-111                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-112                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-82                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-83                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-84                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-29           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-113                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-114         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-115                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-116                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-85                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-86                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-87                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-30           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-117                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-118         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-119                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-120                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-88                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-89                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-90                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-31           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-121                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-122         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-123                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-124                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-91                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-92                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-93                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-32           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-125                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-126         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-127                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-128                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-94                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-95                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-96                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-33           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-129                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-130         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-131                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-132                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-97                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-98                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-99                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-34           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-133                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-134         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-135                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-136                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-100                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-101                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-102                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-35           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-137                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-138         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-139                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-140                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-103                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-104                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-105                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-36           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-141                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-142         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-143                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-144                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-106                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-107                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-108                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â””â”€LayerNorm: 2-12                             [1, 256, 1024]            [1, 256, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€Sequential: 2-13                            [1, 1024, 16, 16]         [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-37                           [1, 1024, 16, 16]         [1, 768, 16, 16]          787,200                     0.20%                   [1, 1]                    201,523,200
â”‚    â”‚    â””â”€Rearrange: 3-38                        [1, 768, 16, 16]          [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â””â”€Conv2d: 2-14                                [1, 3, 256, 256]          [1, 3, 256, 256]          84                          0.00%                   [3, 3]                    5,505,024
========================================================================================================================================================================================================
Total params: 391,391,124
Trainable params: 391,391,124
Non-trainable params: 0
Total mult-adds (G): 94.90
========================================================================================================================================================================================================
Input size (MB): 1.02
Forward/backward pass size (MB): 706.26
Params size (MB): 1046.63
Estimated Total Size (MB): 1753.91
========================================================================================================================================================================================================
[32m[04/13 15:06:38 Tex-Tok]: [0mCreating optimizers.
[32m[04/13 15:06:38 Tex-Tok]: [0mCreating lr_schedulers.
[32m[04/13 15:06:38 Tex-Tok]: [0mCreating dataloaders.
[32m[04/13 15:06:38 Tex-Tok]: [0mCreating evaluator.
[32m[04/13 15:06:38 Tex-Tok]: [0mPreparing model, optimizer and dataloaders
[32m[04/13 15:06:38 Tex-Tok]: [0m***** Running training *****
[32m[04/13 15:06:38 Tex-Tok]: [0m  Num training steps = 650000
[32m[04/13 15:06:38 Tex-Tok]: [0m  Gradient Accumulation steps = 1
[32m[04/13 15:06:38 Tex-Tok]: [0m  Instantaneous batch size per gpu = 16
[32m[04/13 15:06:38 Tex-Tok]: [0m  Total train batch size (w. parallel, distributed & accumulation) = 32
[32m[04/13 15:06:38 Tex-Tok]: [0mAll globbed checkpoints are: []
[32m[04/13 15:06:38 Tex-Tok]: [0mTraining from scratch.
[32m[04/13 15:07:04 Tex-Tok]: [0mData (t): 0.0105, 36.50/s/gpu Batch (t): 0.4383 LR: 0.000001 Step: 50 Total Loss: 2.8926 Recon Loss: 1.6851 
[32m[04/13 15:07:26 Tex-Tok]: [0mData (t): 0.0106, 36.63/s/gpu Batch (t): 0.4368 LR: 0.000001 Step: 100 Total Loss: 2.4941 Recon Loss: 1.5018 
[32m[04/13 15:07:48 Tex-Tok]: [0mData (t): 0.0106, 36.59/s/gpu Batch (t): 0.4372 LR: 0.000002 Step: 150 Total Loss: 2.3606 Recon Loss: 1.5408 
[32m[04/13 15:08:10 Tex-Tok]: [0mData (t): 0.0105, 36.50/s/gpu Batch (t): 0.4384 LR: 0.000002 Step: 200 Total Loss: 2.2233 Recon Loss: 1.4268 
[32m[04/13 15:08:32 Tex-Tok]: [0mData (t): 0.0106, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000003 Step: 250 Total Loss: 2.3691 Recon Loss: 1.6342 
[32m[04/13 15:08:54 Tex-Tok]: [0mData (t): 0.0107, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000003 Step: 300 Total Loss: 1.8517 Recon Loss: 1.1012 
[32m[04/13 15:09:16 Tex-Tok]: [0mData (t): 0.0104, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000004 Step: 350 Total Loss: 2.1951 Recon Loss: 1.4484 
[32m[04/13 15:09:37 Tex-Tok]: [0mData (t): 0.0105, 36.44/s/gpu Batch (t): 0.4390 LR: 0.000004 Step: 400 Total Loss: 2.0126 Recon Loss: 1.2810 
[32m[04/13 15:09:59 Tex-Tok]: [0mData (t): 0.0105, 36.43/s/gpu Batch (t): 0.4392 LR: 0.000005 Step: 450 Total Loss: 2.3286 Recon Loss: 1.5947 
[32m[04/13 15:10:21 Tex-Tok]: [0mData (t): 0.0105, 36.55/s/gpu Batch (t): 0.4378 LR: 0.000005 Step: 500 Total Loss: 2.2389 Recon Loss: 1.5031 
[32m[04/13 15:10:22 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:14:32 Tex-Tok]: [0mSaving config to textok_bl32_vq_run3/config.yaml
[32m[04/13 15:14:32 Tex-Tok]: [0mConfig:
experiment:
  project: textok_bl32_vq
  name: textok_bl32_vq_run3
  output_dir: textok_bl32_vq_run3
  max_train_examples: 685800000
  save_every: 50000
  eval_every: 50000
  generate_every: 500
  log_every: 50
  log_grad_norm_every: 1000
  resume: true
  logging_dir: textok_bl32_vq_run3/logs
model:
  vq_model:
    quantize_mode: vq
    codebook_size: 8192
    token_size: 64
    use_l2_norm: false
    commitment_cost: 0.25
    clustering_vq: true
    vit_enc_model_size: base
    vit_dec_model_size: large
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 32
    finetune_decoder: false
    is_legacy: false
    text_embed_dim: 768
losses:
  discriminator_start: 200000
  quantizer_weight: 1.0
  discriminator_factor: 1.0
  discriminator_weight: 0.1
  perceptual_loss: lpips-convnext_s-1.0-0.1
  perceptual_weight: 1.1
  reconstruction_loss: l2
  reconstruction_weight: 1.0
  lecam_regularization_weight: 0.001
dataset:
  params:
    train_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-train-{000000..000160}.tar
    eval_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-val-{000000..000049}.tar
    num_workers_per_gpu: 12
    dataset_with_class_label: false
    dataset_with_text_label: true
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
    res_ratio_filtering: true
    normalize_mean:
    - 0.485
    - 0.456
    - 0.406
    normalize_std:
    - 0.229
    - 0.224
    - 0.225
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    discriminator_learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.999
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 16
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 650000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/TexTok/textok_bl32_vq.yaml

[32m[04/13 15:14:32 Tex-Tok]: [0mCreating model and loss module.
[32m[04/13 15:14:37 Tex-Tok]: [0m========================================================================================================================================================================================================
Layer (type:depth-idx)                             Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
========================================================================================================================================================================================================
Textok                                             [1, 3, 256, 256]          [1, 3, 256, 256]          24,576                      0.01%                   --                        --
â”œâ”€TexTokEncoder: 1-1                               --                        [1, 64, 1, 32]            222,720                     0.06%                   --                        --
â”‚    â””â”€Conv2d: 2-1                                 [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.15%                   [16, 16]                  151,191,552
â”‚    â””â”€Linear: 2-2                                 [1, 77, 768]              [1, 77, 768]              590,592                     0.15%                   --                        590,592
â”‚    â””â”€LayerNorm: 2-3                              [1, 366, 768]             [1, 366, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€ModuleList: 2-4                             --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-1            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-1                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-2           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-3                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-4                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-1                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-2                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-3                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-2            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-5                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-6           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-7                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-8                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-4                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-5                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-6                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-3            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-9                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-10          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-11                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-12                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-7                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-8                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-9                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-4            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-13                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-14          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-15                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-16                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-10                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-11                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-12                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-5            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-17                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-18          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-19                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-20                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-13                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-14                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-15                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-6            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-21                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-22          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-23                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-24                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-16                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-17                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-18                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-7            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-25                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-26          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-27                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-28                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-19                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-20                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-21                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-8            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-29                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-30          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-31                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-32                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-22                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-23                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-24                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-9            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-33                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-34          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-35                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-36                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-25                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-26                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-27                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-10           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-37                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-38          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-39                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-40                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-28                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-29                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-30                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-11           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-41                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-42          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-43                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-44                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-31                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-32                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-33                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-12           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-45                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-46          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-47                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-48                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-34                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-35                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-36                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â””â”€LayerNorm: 2-5                              [1, 32, 768]              [1, 32, 768]              1,536                       0.00%                   --                        1,536
â”‚    â””â”€Conv2d: 2-6                                 [1, 768, 32, 1]           [1, 64, 32, 1]            49,216                      0.01%                   [1, 1]                    1,574,912
â”œâ”€VectorQuantizer: 1-2                             [1, 64, 1, 32]            [1, 64, 1, 32]            --                             --                   --                        --
â”‚    â””â”€Embedding: 2-7                              [32]                      [32, 64]                  524,288                     0.13%                   --                        16,777,216
â”œâ”€TATiTokDecoder: 1-3                              [1, 64, 1, 32]            [1, 3, 256, 256]          376,832                     0.10%                   --                        --
â”‚    â””â”€Linear: 2-8                                 [1, 32, 64]               [1, 32, 1024]             66,560                      0.02%                   --                        66,560
â”‚    â””â”€Linear: 2-9                                 [1, 77, 768]              [1, 77, 1024]             787,456                     0.20%                   --                        787,456
â”‚    â””â”€LayerNorm: 2-10                             [1, 366, 1024]            [1, 366, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€ModuleList: 2-11                            --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-13           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-49                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-50          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-51                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-52                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-37                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-38                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-39                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-14           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-53                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-54          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-55                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-56                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-40                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-41                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-42                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-15           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-57                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-58          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-59                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-60                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-43                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-44                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-45                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-16           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-61                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-62          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-63                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-64                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-46                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-47                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-48                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-17           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-65                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-66          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-67                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-68                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-49                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-50                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-51                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-18           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-69                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-70          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-71                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-72                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-52                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-53                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-54                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-19           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-73                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-74          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-75                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-76                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-55                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-56                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-57                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-20           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-77                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-78          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-79                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-80                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-58                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-59                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-60                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-21           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-81                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-82          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-83                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-84                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-61                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-62                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-63                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-22           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-85                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-86          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-87                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-88                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-64                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-65                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-66                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-23           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-89                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-90          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-91                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-92                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-67                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-68                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-69                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-24           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-93                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-94          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-95                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-96                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-70                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-71                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-72                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-25           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-97                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-98          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-99                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-100                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-73                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-74                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-75                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-26           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-101                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-102         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-103                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-104                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-76                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-77                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-78                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-27           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-105                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-106         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-107                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-108                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-79                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-80                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-81                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-28           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-109                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-110         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-111                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-112                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-82                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-83                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-84                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-29           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-113                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-114         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-115                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-116                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-85                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-86                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-87                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-30           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-117                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-118         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-119                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-120                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-88                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-89                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-90                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-31           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-121                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-122         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-123                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-124                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-91                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-92                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-93                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-32           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-125                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-126         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-127                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-128                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-94                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-95                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-96                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-33           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-129                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-130         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-131                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-132                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-97                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-98                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-99                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-34           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-133                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-134         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-135                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-136                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-100                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-101                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-102                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-35           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-137                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-138         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-139                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-140                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-103                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-104                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-105                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-36           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-141                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-142         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-143                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-144                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-106                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-107                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-108                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â””â”€LayerNorm: 2-12                             [1, 256, 1024]            [1, 256, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€Sequential: 2-13                            [1, 1024, 16, 16]         [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-37                           [1, 1024, 16, 16]         [1, 768, 16, 16]          787,200                     0.20%                   [1, 1]                    201,523,200
â”‚    â”‚    â””â”€Rearrange: 3-38                        [1, 768, 16, 16]          [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â””â”€Conv2d: 2-14                                [1, 3, 256, 256]          [1, 3, 256, 256]          84                          0.00%                   [3, 3]                    5,505,024
========================================================================================================================================================================================================
Total params: 391,391,124
Trainable params: 391,391,124
Non-trainable params: 0
Total mult-adds (G): 94.90
========================================================================================================================================================================================================
Input size (MB): 1.02
Forward/backward pass size (MB): 706.26
Params size (MB): 1046.63
Estimated Total Size (MB): 1753.91
========================================================================================================================================================================================================
[32m[04/13 15:14:38 Tex-Tok]: [0mCreating optimizers.
[32m[04/13 15:14:38 Tex-Tok]: [0mCreating lr_schedulers.
[32m[04/13 15:14:38 Tex-Tok]: [0mCreating dataloaders.
[32m[04/13 15:14:38 Tex-Tok]: [0mCreating evaluator.
[32m[04/13 15:14:39 Tex-Tok]: [0mPreparing model, optimizer and dataloaders
[32m[04/13 15:14:39 Tex-Tok]: [0m***** Running training *****
[32m[04/13 15:14:39 Tex-Tok]: [0m  Num training steps = 650000
[32m[04/13 15:14:39 Tex-Tok]: [0m  Gradient Accumulation steps = 1
[32m[04/13 15:14:39 Tex-Tok]: [0m  Instantaneous batch size per gpu = 16
[32m[04/13 15:14:39 Tex-Tok]: [0m  Total train batch size (w. parallel, distributed & accumulation) = 32
[32m[04/13 15:14:39 Tex-Tok]: [0mAll globbed checkpoints are: []
[32m[04/13 15:14:39 Tex-Tok]: [0mTraining from scratch.
[32m[04/13 15:15:05 Tex-Tok]: [0mData (t): 0.0104, 36.65/s/gpu Batch (t): 0.4366 LR: 0.000001 Step: 50 Total Loss: 3.0192 Recon Loss: 1.7960 
[32m[04/13 15:15:27 Tex-Tok]: [0mData (t): 0.0104, 36.34/s/gpu Batch (t): 0.4402 LR: 0.000001 Step: 100 Total Loss: 2.2826 Recon Loss: 1.3223 
[32m[04/13 15:15:49 Tex-Tok]: [0mData (t): 0.0104, 36.59/s/gpu Batch (t): 0.4372 LR: 0.000002 Step: 150 Total Loss: 2.3137 Recon Loss: 1.4742 
[32m[04/13 15:16:11 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000002 Step: 200 Total Loss: 2.4545 Recon Loss: 1.6448 
[32m[04/13 15:16:33 Tex-Tok]: [0mData (t): 0.0104, 36.66/s/gpu Batch (t): 0.4364 LR: 0.000003 Step: 250 Total Loss: 2.1086 Recon Loss: 1.3501 
[32m[04/13 15:16:55 Tex-Tok]: [0mData (t): 0.0106, 36.62/s/gpu Batch (t): 0.4369 LR: 0.000003 Step: 300 Total Loss: 2.2841 Recon Loss: 1.5230 
[32m[04/13 15:17:17 Tex-Tok]: [0mData (t): 0.0105, 36.37/s/gpu Batch (t): 0.4400 LR: 0.000004 Step: 350 Total Loss: 2.3659 Recon Loss: 1.6085 
[32m[04/13 15:17:38 Tex-Tok]: [0mData (t): 0.0104, 36.61/s/gpu Batch (t): 0.4371 LR: 0.000004 Step: 400 Total Loss: 2.1610 Recon Loss: 1.4067 
[32m[04/13 15:18:00 Tex-Tok]: [0mData (t): 0.0106, 36.50/s/gpu Batch (t): 0.4384 LR: 0.000005 Step: 450 Total Loss: 2.0357 Recon Loss: 1.2860 
[32m[04/13 15:18:22 Tex-Tok]: [0mData (t): 0.0104, 36.54/s/gpu Batch (t): 0.4379 LR: 0.000005 Step: 500 Total Loss: 2.5287 Recon Loss: 1.8025 
[32m[04/13 15:18:23 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:19:00 Tex-Tok]: [0mData (t): 0.0106, 36.41/s/gpu Batch (t): 0.4394 LR: 0.000006 Step: 550 Total Loss: 1.9811 Recon Loss: 1.2398 
[32m[04/13 15:19:22 Tex-Tok]: [0mData (t): 0.0105, 36.65/s/gpu Batch (t): 0.4366 LR: 0.000006 Step: 600 Total Loss: 2.5062 Recon Loss: 1.6145 
[32m[04/13 15:19:44 Tex-Tok]: [0mData (t): 0.0105, 36.45/s/gpu Batch (t): 0.4389 LR: 0.000007 Step: 650 Total Loss: 1.9103 Recon Loss: 1.1388 
[32m[04/13 15:20:06 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000007 Step: 700 Total Loss: 1.9948 Recon Loss: 1.2392 
[32m[04/13 15:20:28 Tex-Tok]: [0mData (t): 0.0106, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000008 Step: 750 Total Loss: 1.9211 Recon Loss: 1.1864 
[32m[04/13 15:20:50 Tex-Tok]: [0mData (t): 0.0105, 36.56/s/gpu Batch (t): 0.4376 LR: 0.000008 Step: 800 Total Loss: 1.9893 Recon Loss: 1.2177 
[32m[04/13 15:21:11 Tex-Tok]: [0mData (t): 0.0106, 36.30/s/gpu Batch (t): 0.4408 LR: 0.000009 Step: 850 Total Loss: 2.0544 Recon Loss: 1.2952 
[32m[04/13 15:21:33 Tex-Tok]: [0mData (t): 0.0118, 36.56/s/gpu Batch (t): 0.4376 LR: 0.000009 Step: 900 Total Loss: 1.9955 Recon Loss: 1.2292 
[32m[04/13 15:21:55 Tex-Tok]: [0mData (t): 0.0105, 36.46/s/gpu Batch (t): 0.4388 LR: 0.000010 Step: 950 Total Loss: 2.0847 Recon Loss: 1.3345 
[32m[04/13 15:22:17 Tex-Tok]: [0mData (t): 0.0104, 31.67/s/gpu Batch (t): 0.5053 LR: 0.000010 Step: 1000 Total Loss: 2.0303 Recon Loss: 1.2233 
[32m[04/13 15:22:18 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:26:24 Tex-Tok]: [0mSaving config to textok_bl32_vq_run3/config.yaml
[32m[04/13 15:26:24 Tex-Tok]: [0mConfig:
experiment:
  project: textok_bl32_vq
  name: textok_bl32_vq_run3
  output_dir: textok_bl32_vq_run3
  max_train_examples: 685800000
  save_every: 50000
  eval_every: 50000
  generate_every: 500
  log_every: 50
  log_grad_norm_every: 1000
  resume: true
  logging_dir: textok_bl32_vq_run3/logs
model:
  vq_model:
    quantize_mode: vq
    codebook_size: 8192
    token_size: 64
    use_l2_norm: false
    commitment_cost: 0.25
    clustering_vq: true
    vit_enc_model_size: base
    vit_dec_model_size: large
    vit_enc_patch_size: 16
    vit_dec_patch_size: 16
    num_latent_tokens: 32
    finetune_decoder: false
    is_legacy: false
    text_embed_dim: 768
losses:
  discriminator_start: 200000
  quantizer_weight: 1.0
  discriminator_factor: 1.0
  discriminator_weight: 0.1
  perceptual_loss: lpips-convnext_s-1.0-0.1
  perceptual_weight: 1.1
  reconstruction_loss: l2
  reconstruction_weight: 1.0
  lecam_regularization_weight: 0.001
dataset:
  params:
    train_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-train-{000000..000160}.tar
    eval_shards_path_or_url: /data/san/HF_datasets/imgnet-1k-caption-wds/imagenet1k-val-{000000..000049}.tar
    num_workers_per_gpu: 12
    dataset_with_class_label: false
    dataset_with_text_label: true
  preprocessing:
    resize_shorter_edge: 256
    crop_size: 256
    random_crop: true
    random_flip: true
    res_ratio_filtering: true
    normalize_mean:
    - 0.485
    - 0.456
    - 0.406
    normalize_std:
    - 0.229
    - 0.224
    - 0.225
optimizer:
  name: adamw
  params:
    learning_rate: 0.0001
    discriminator_learning_rate: 0.0001
    beta1: 0.9
    beta2: 0.999
    weight_decay: 0.0001
lr_scheduler:
  scheduler: cosine
  params:
    learning_rate: ${optimizer.params.learning_rate}
    warmup_steps: 10000
    end_lr: 1.0e-05
training:
  gradient_accumulation_steps: 1
  per_gpu_batch_size: 16
  mixed_precision: fp16
  enable_tf32: true
  enable_wandb: true
  use_ema: true
  seed: 42
  max_train_steps: 650000
  num_generated_images: 2
  max_grad_norm: 1.0
config: configs/training/TexTok/textok_bl32_vq.yaml

[32m[04/13 15:26:25 Tex-Tok]: [0mCreating model and loss module.
[32m[04/13 15:26:29 Tex-Tok]: [0m========================================================================================================================================================================================================
Layer (type:depth-idx)                             Input Shape               Output Shape              Param #                   Param %                   Kernel Shape              Mult-Adds
========================================================================================================================================================================================================
Textok                                             [1, 3, 256, 256]          [1, 3, 256, 256]          24,576                      0.01%                   --                        --
â”œâ”€TexTokEncoder: 1-1                               --                        [1, 64, 1, 32]            222,720                     0.06%                   --                        --
â”‚    â””â”€Conv2d: 2-1                                 [1, 3, 256, 256]          [1, 768, 16, 16]          590,592                     0.15%                   [16, 16]                  151,191,552
â”‚    â””â”€Linear: 2-2                                 [1, 77, 768]              [1, 77, 768]              590,592                     0.15%                   --                        590,592
â”‚    â””â”€LayerNorm: 2-3                              [1, 366, 768]             [1, 366, 768]             1,536                       0.00%                   --                        1,536
â”‚    â””â”€ModuleList: 2-4                             --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-1            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-1                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-2           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-3                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-4                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-1                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-2                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-3                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-2            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-5                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-6           [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-7                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-8                   [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-4                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-5                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-6                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-3            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-9                    [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-10          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-11                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-12                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-7                  [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-8                    [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-9                  [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-4            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-13                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-14          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-15                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-16                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-10                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-11                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-12                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-5            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-17                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-18          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-19                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-20                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-13                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-14                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-15                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-6            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-21                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-22          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-23                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-24                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-16                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-17                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-18                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-7            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-25                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-26          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-27                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-28                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-19                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-20                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-21                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-8            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-29                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-30          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-31                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-32                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-22                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-23                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-24                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-9            [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-33                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-34          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-35                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-36                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-25                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-26                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-27                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-10           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-37                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-38          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-39                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-40                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-28                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-29                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-30                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-11           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-41                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-42          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-43                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-44                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-31                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-32                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-33                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-12           [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-45                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-46          [366, 1, 768]             [366, 1, 768]             2,362,368                   0.60%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-47                   [366, 1, 768]             [366, 1, 768]             1,536                       0.00%                   --                        562,176
â”‚    â”‚    â”‚    â””â”€Sequential: 4-48                  [366, 1, 768]             [366, 1, 768]             --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-34                 [366, 1, 768]             [366, 1, 3072]            2,362,368                   0.60%                   --                        864,626,688
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-35                   [366, 1, 3072]            [366, 1, 3072]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-36                 [366, 1, 3072]            [366, 1, 768]             2,360,064                   0.60%                   --                        863,783,424
â”‚    â””â”€LayerNorm: 2-5                              [1, 32, 768]              [1, 32, 768]              1,536                       0.00%                   --                        1,536
â”‚    â””â”€Conv2d: 2-6                                 [1, 768, 32, 1]           [1, 64, 32, 1]            49,216                      0.01%                   [1, 1]                    1,574,912
â”œâ”€VectorQuantizer: 1-2                             [1, 64, 1, 32]            [1, 64, 1, 32]            --                             --                   --                        --
â”‚    â””â”€Embedding: 2-7                              [32]                      [32, 64]                  524,288                     0.13%                   --                        16,777,216
â”œâ”€TATiTokDecoder: 1-3                              [1, 64, 1, 32]            [1, 3, 256, 256]          376,832                     0.10%                   --                        --
â”‚    â””â”€Linear: 2-8                                 [1, 32, 64]               [1, 32, 1024]             66,560                      0.02%                   --                        66,560
â”‚    â””â”€Linear: 2-9                                 [1, 77, 768]              [1, 77, 1024]             787,456                     0.20%                   --                        787,456
â”‚    â””â”€LayerNorm: 2-10                             [1, 366, 1024]            [1, 366, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€ModuleList: 2-11                            --                        --                        --                             --                   --                        --
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-13           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-49                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-50          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-51                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-52                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-37                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-38                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-39                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-14           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-53                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-54          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-55                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-56                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-40                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-41                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-42                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-15           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-57                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-58          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-59                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-60                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-43                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-44                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-45                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-16           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-61                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-62          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-63                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-64                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-46                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-47                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-48                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-17           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-65                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-66          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-67                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-68                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-49                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-50                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-51                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-18           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-69                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-70          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-71                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-72                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-52                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-53                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-54                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-19           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-73                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-74          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-75                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-76                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-55                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-56                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-57                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-20           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-77                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-78          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-79                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-80                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-58                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-59                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-60                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-21           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-81                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-82          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-83                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-84                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-61                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-62                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-63                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-22           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-85                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-86          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-87                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-88                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-64                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-65                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-66                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-23           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-89                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-90          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-91                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-92                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-67                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-68                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-69                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-24           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-93                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-94          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-95                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-96                  [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-70                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-71                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-72                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-25           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-97                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-98          [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-99                   [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-100                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-73                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-74                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-75                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-26           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-101                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-102         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-103                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-104                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-76                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-77                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-78                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-27           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-105                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-106         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-107                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-108                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-79                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-80                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-81                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-28           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-109                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-110         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-111                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-112                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-82                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-83                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-84                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-29           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-113                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-114         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-115                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-116                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-85                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-86                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-87                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-30           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-117                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-118         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-119                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-120                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-88                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-89                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-90                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-31           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-121                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-122         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-123                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-124                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-91                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-92                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-93                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-32           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-125                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-126         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-127                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-128                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-94                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-95                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-96                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-33           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-129                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-130         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-131                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-132                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-97                 [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-98                   [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-99                 [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-34           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-133                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-134         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-135                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-136                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-100                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-101                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-102                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-35           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-137                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-138         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-139                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-140                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-103                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-104                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-105                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â”‚    â””â”€ResidualAttentionBlock: 3-36           [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-141                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€MultiheadAttention: 4-142         [366, 1, 1024]            [366, 1, 1024]            4,198,400                   1.07%                   --                        --
â”‚    â”‚    â”‚    â””â”€LayerNorm: 4-143                  [366, 1, 1024]            [366, 1, 1024]            2,048                       0.00%                   --                        749,568
â”‚    â”‚    â”‚    â””â”€Sequential: 4-144                 [366, 1, 1024]            [366, 1, 1024]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-106                [366, 1, 1024]            [366, 1, 4096]            4,198,400                   1.07%                   --                        1,536,614,400
â”‚    â”‚    â”‚    â”‚    â””â”€GELU: 5-107                  [366, 1, 4096]            [366, 1, 4096]            --                             --                   --                        --
â”‚    â”‚    â”‚    â”‚    â””â”€Linear: 5-108                [366, 1, 4096]            [366, 1, 1024]            4,195,328                   1.07%                   --                        1,535,490,048
â”‚    â””â”€LayerNorm: 2-12                             [1, 256, 1024]            [1, 256, 1024]            2,048                       0.00%                   --                        2,048
â”‚    â””â”€Sequential: 2-13                            [1, 1024, 16, 16]         [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â”‚    â””â”€Conv2d: 3-37                           [1, 1024, 16, 16]         [1, 768, 16, 16]          787,200                     0.20%                   [1, 1]                    201,523,200
â”‚    â”‚    â””â”€Rearrange: 3-38                        [1, 768, 16, 16]          [1, 3, 256, 256]          --                             --                   --                        --
â”‚    â””â”€Conv2d: 2-14                                [1, 3, 256, 256]          [1, 3, 256, 256]          84                          0.00%                   [3, 3]                    5,505,024
========================================================================================================================================================================================================
Total params: 391,391,124
Trainable params: 391,391,124
Non-trainable params: 0
Total mult-adds (G): 94.90
========================================================================================================================================================================================================
Input size (MB): 1.02
Forward/backward pass size (MB): 706.26
Params size (MB): 1046.63
Estimated Total Size (MB): 1753.91
========================================================================================================================================================================================================
[32m[04/13 15:26:31 Tex-Tok]: [0mCreating optimizers.
[32m[04/13 15:26:31 Tex-Tok]: [0mCreating lr_schedulers.
[32m[04/13 15:26:31 Tex-Tok]: [0mCreating dataloaders.
[32m[04/13 15:26:31 Tex-Tok]: [0mCreating evaluator.
[32m[04/13 15:26:31 Tex-Tok]: [0mPreparing model, optimizer and dataloaders
[32m[04/13 15:26:31 Tex-Tok]: [0m***** Running training *****
[32m[04/13 15:26:31 Tex-Tok]: [0m  Num training steps = 650000
[32m[04/13 15:26:31 Tex-Tok]: [0m  Gradient Accumulation steps = 1
[32m[04/13 15:26:31 Tex-Tok]: [0m  Instantaneous batch size per gpu = 16
[32m[04/13 15:26:31 Tex-Tok]: [0m  Total train batch size (w. parallel, distributed & accumulation) = 32
[32m[04/13 15:26:31 Tex-Tok]: [0mAll globbed checkpoints are: []
[32m[04/13 15:26:31 Tex-Tok]: [0mTraining from scratch.
[32m[04/13 15:26:57 Tex-Tok]: [0mData (t): 0.0110, 36.56/s/gpu Batch (t): 0.4376 LR: 0.000001 Step: 50 Total Loss: 2.7401 Recon Loss: 1.5456 
[32m[04/13 15:27:19 Tex-Tok]: [0mData (t): 0.0106, 36.34/s/gpu Batch (t): 0.4403 LR: 0.000001 Step: 100 Total Loss: 2.5991 Recon Loss: 1.6514 
[32m[04/13 15:27:41 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000002 Step: 150 Total Loss: 2.3799 Recon Loss: 1.5165 
[32m[04/13 15:28:03 Tex-Tok]: [0mData (t): 0.0104, 36.56/s/gpu Batch (t): 0.4376 LR: 0.000002 Step: 200 Total Loss: 2.4456 Recon Loss: 1.6749 
[32m[04/13 15:28:25 Tex-Tok]: [0mData (t): 0.0104, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000003 Step: 250 Total Loss: 2.0927 Recon Loss: 1.3540 
[32m[04/13 15:28:47 Tex-Tok]: [0mData (t): 0.0105, 36.40/s/gpu Batch (t): 0.4396 LR: 0.000003 Step: 300 Total Loss: 2.1744 Recon Loss: 1.4293 
[32m[04/13 15:29:09 Tex-Tok]: [0mData (t): 0.0105, 36.61/s/gpu Batch (t): 0.4371 LR: 0.000004 Step: 350 Total Loss: 2.1000 Recon Loss: 1.3443 
[32m[04/13 15:29:31 Tex-Tok]: [0mData (t): 0.0105, 36.36/s/gpu Batch (t): 0.4400 LR: 0.000004 Step: 400 Total Loss: 2.3880 Recon Loss: 1.6546 
[32m[04/13 15:29:53 Tex-Tok]: [0mData (t): 0.0106, 36.61/s/gpu Batch (t): 0.4371 LR: 0.000005 Step: 450 Total Loss: 2.3299 Recon Loss: 1.5950 
[32m[04/13 15:30:15 Tex-Tok]: [0mData (t): 0.0107, 36.39/s/gpu Batch (t): 0.4397 LR: 0.000005 Step: 500 Total Loss: 2.2189 Recon Loss: 1.4749 
[32m[04/13 15:30:15 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:30:38 Tex-Tok]: [0mData (t): 0.0104, 36.44/s/gpu Batch (t): 0.4390 LR: 0.000006 Step: 550 Total Loss: 2.2144 Recon Loss: 1.4503 
[32m[04/13 15:30:59 Tex-Tok]: [0mData (t): 0.0105, 36.64/s/gpu Batch (t): 0.4367 LR: 0.000006 Step: 600 Total Loss: 2.0930 Recon Loss: 1.3148 
[32m[04/13 15:31:21 Tex-Tok]: [0mData (t): 0.0105, 36.54/s/gpu Batch (t): 0.4379 LR: 0.000007 Step: 650 Total Loss: 1.8558 Recon Loss: 1.1053 
[32m[04/13 15:31:43 Tex-Tok]: [0mData (t): 0.0104, 36.63/s/gpu Batch (t): 0.4368 LR: 0.000007 Step: 700 Total Loss: 1.9766 Recon Loss: 1.2217 
[32m[04/13 15:32:05 Tex-Tok]: [0mData (t): 0.0106, 36.25/s/gpu Batch (t): 0.4414 LR: 0.000008 Step: 750 Total Loss: 1.9961 Recon Loss: 1.1973 
[32m[04/13 15:32:27 Tex-Tok]: [0mData (t): 0.0105, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000008 Step: 800 Total Loss: 1.9615 Recon Loss: 1.1776 
[32m[04/13 15:32:49 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000009 Step: 850 Total Loss: 1.8563 Recon Loss: 1.1487 
[32m[04/13 15:33:11 Tex-Tok]: [0mData (t): 0.0105, 36.44/s/gpu Batch (t): 0.4390 LR: 0.000009 Step: 900 Total Loss: 1.8556 Recon Loss: 1.1495 
[32m[04/13 15:33:33 Tex-Tok]: [0mData (t): 0.0104, 36.65/s/gpu Batch (t): 0.4366 LR: 0.000010 Step: 950 Total Loss: 1.7994 Recon Loss: 1.1204 
[32m[04/13 15:33:55 Tex-Tok]: [0mData (t): 0.0104, 31.90/s/gpu Batch (t): 0.5016 LR: 0.000010 Step: 1000 Total Loss: 1.7957 Recon Loss: 1.1016 
[32m[04/13 15:33:55 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:34:17 Tex-Tok]: [0mData (t): 0.0106, 36.45/s/gpu Batch (t): 0.4389 LR: 0.000010 Step: 1050 Total Loss: 1.7878 Recon Loss: 1.0913 
[32m[04/13 15:34:39 Tex-Tok]: [0mData (t): 0.0104, 36.33/s/gpu Batch (t): 0.4405 LR: 0.000011 Step: 1100 Total Loss: 1.9015 Recon Loss: 1.1977 
[32m[04/13 15:35:01 Tex-Tok]: [0mData (t): 0.0104, 36.48/s/gpu Batch (t): 0.4386 LR: 0.000012 Step: 1150 Total Loss: 2.1161 Recon Loss: 1.4090 
[32m[04/13 15:35:23 Tex-Tok]: [0mData (t): 0.0104, 36.34/s/gpu Batch (t): 0.4403 LR: 0.000012 Step: 1200 Total Loss: 1.7257 Recon Loss: 1.0200 
[32m[04/13 15:35:45 Tex-Tok]: [0mData (t): 0.0105, 36.51/s/gpu Batch (t): 0.4382 LR: 0.000013 Step: 1250 Total Loss: 1.6437 Recon Loss: 0.9692 
[32m[04/13 15:36:07 Tex-Tok]: [0mData (t): 0.0104, 36.38/s/gpu Batch (t): 0.4398 LR: 0.000013 Step: 1300 Total Loss: 1.9332 Recon Loss: 1.2162 
[32m[04/13 15:36:29 Tex-Tok]: [0mData (t): 0.0106, 36.39/s/gpu Batch (t): 0.4397 LR: 0.000014 Step: 1350 Total Loss: 1.7421 Recon Loss: 1.0567 
[32m[04/13 15:36:51 Tex-Tok]: [0mData (t): 0.0106, 36.45/s/gpu Batch (t): 0.4390 LR: 0.000014 Step: 1400 Total Loss: 1.7927 Recon Loss: 1.0040 
[32m[04/13 15:37:13 Tex-Tok]: [0mData (t): 0.0104, 36.66/s/gpu Batch (t): 0.4364 LR: 0.000015 Step: 1450 Total Loss: 1.7923 Recon Loss: 1.0690 
[32m[04/13 15:37:34 Tex-Tok]: [0mData (t): 0.0106, 36.52/s/gpu Batch (t): 0.4382 LR: 0.000015 Step: 1500 Total Loss: 1.8306 Recon Loss: 1.0751 
[32m[04/13 15:37:35 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:37:57 Tex-Tok]: [0mData (t): 0.0105, 36.62/s/gpu Batch (t): 0.4370 LR: 0.000016 Step: 1550 Total Loss: 1.7001 Recon Loss: 0.9607 
[32m[04/13 15:38:19 Tex-Tok]: [0mData (t): 0.0105, 36.60/s/gpu Batch (t): 0.4371 LR: 0.000016 Step: 1600 Total Loss: 1.7742 Recon Loss: 0.9925 
[32m[04/13 15:38:41 Tex-Tok]: [0mData (t): 0.0107, 36.51/s/gpu Batch (t): 0.4383 LR: 0.000017 Step: 1650 Total Loss: 1.8046 Recon Loss: 1.0936 
[32m[04/13 15:39:03 Tex-Tok]: [0mData (t): 0.0104, 36.60/s/gpu Batch (t): 0.4372 LR: 0.000017 Step: 1700 Total Loss: 2.0407 Recon Loss: 1.1636 
[32m[04/13 15:39:25 Tex-Tok]: [0mData (t): 0.0104, 36.55/s/gpu Batch (t): 0.4377 LR: 0.000017 Step: 1750 Total Loss: 1.8379 Recon Loss: 0.9771 
[32m[04/13 15:39:47 Tex-Tok]: [0mData (t): 0.0105, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000018 Step: 1800 Total Loss: 2.0072 Recon Loss: 1.1453 
[32m[04/13 15:40:08 Tex-Tok]: [0mData (t): 0.0106, 36.34/s/gpu Batch (t): 0.4403 LR: 0.000018 Step: 1850 Total Loss: 1.8413 Recon Loss: 1.0610 
[32m[04/13 15:40:30 Tex-Tok]: [0mData (t): 0.0105, 36.34/s/gpu Batch (t): 0.4402 LR: 0.000019 Step: 1900 Total Loss: 1.9589 Recon Loss: 1.0351 
[32m[04/13 15:40:52 Tex-Tok]: [0mData (t): 0.0106, 36.55/s/gpu Batch (t): 0.4378 LR: 0.000020 Step: 1950 Total Loss: 2.1377 Recon Loss: 0.9834 
[32m[04/13 15:41:14 Tex-Tok]: [0mData (t): 0.0105, 33.13/s/gpu Batch (t): 0.4830 LR: 0.000020 Step: 2000 Total Loss: 1.7786 Recon Loss: 1.0431 
[32m[04/13 15:41:15 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:41:37 Tex-Tok]: [0mData (t): 0.0105, 36.56/s/gpu Batch (t): 0.4376 LR: 0.000021 Step: 2050 Total Loss: 1.9573 Recon Loss: 1.1623 
[32m[04/13 15:41:59 Tex-Tok]: [0mData (t): 0.0105, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000021 Step: 2100 Total Loss: 1.9153 Recon Loss: 1.1067 
[32m[04/13 15:42:21 Tex-Tok]: [0mData (t): 0.0105, 36.55/s/gpu Batch (t): 0.4378 LR: 0.000021 Step: 2150 Total Loss: 1.8974 Recon Loss: 0.9502 
[32m[04/13 15:42:42 Tex-Tok]: [0mData (t): 0.0113, 36.55/s/gpu Batch (t): 0.4377 LR: 0.000022 Step: 2200 Total Loss: 1.8658 Recon Loss: 1.0360 
[32m[04/13 15:43:04 Tex-Tok]: [0mData (t): 0.0106, 36.55/s/gpu Batch (t): 0.4378 LR: 0.000022 Step: 2250 Total Loss: 1.8196 Recon Loss: 1.0316 
[32m[04/13 15:43:26 Tex-Tok]: [0mData (t): 0.0104, 36.51/s/gpu Batch (t): 0.4382 LR: 0.000023 Step: 2300 Total Loss: 1.9683 Recon Loss: 1.1806 
[32m[04/13 15:43:48 Tex-Tok]: [0mData (t): 0.0105, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000023 Step: 2350 Total Loss: 2.0618 Recon Loss: 1.0824 
[32m[04/13 15:44:10 Tex-Tok]: [0mData (t): 0.0105, 36.48/s/gpu Batch (t): 0.4385 LR: 0.000024 Step: 2400 Total Loss: 1.8289 Recon Loss: 0.9053 
[32m[04/13 15:44:32 Tex-Tok]: [0mData (t): 0.0105, 36.52/s/gpu Batch (t): 0.4381 LR: 0.000024 Step: 2450 Total Loss: 1.7791 Recon Loss: 1.0005 
[32m[04/13 15:44:54 Tex-Tok]: [0mData (t): 0.0105, 36.59/s/gpu Batch (t): 0.4372 LR: 0.000025 Step: 2500 Total Loss: 1.6266 Recon Loss: 0.9119 
[32m[04/13 15:44:54 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:45:17 Tex-Tok]: [0mData (t): 0.0107, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000025 Step: 2550 Total Loss: 2.0628 Recon Loss: 1.1820 
[32m[04/13 15:45:38 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000026 Step: 2600 Total Loss: 1.5442 Recon Loss: 0.8518 
[32m[04/13 15:46:00 Tex-Tok]: [0mData (t): 0.0105, 36.61/s/gpu Batch (t): 0.4371 LR: 0.000026 Step: 2650 Total Loss: 1.8393 Recon Loss: 1.1360 
[32m[04/13 15:46:22 Tex-Tok]: [0mData (t): 0.0105, 36.41/s/gpu Batch (t): 0.4395 LR: 0.000027 Step: 2700 Total Loss: 1.6456 Recon Loss: 0.9294 
[32m[04/13 15:46:44 Tex-Tok]: [0mData (t): 0.0105, 36.50/s/gpu Batch (t): 0.4383 LR: 0.000027 Step: 2750 Total Loss: 1.7504 Recon Loss: 0.9705 
[32m[04/13 15:47:06 Tex-Tok]: [0mData (t): 0.0105, 36.56/s/gpu Batch (t): 0.4376 LR: 0.000028 Step: 2800 Total Loss: 1.8510 Recon Loss: 1.0917 
[32m[04/13 15:47:28 Tex-Tok]: [0mData (t): 0.0114, 35.64/s/gpu Batch (t): 0.4489 LR: 0.000028 Step: 2850 Total Loss: 2.0168 Recon Loss: 1.2106 
[32m[04/13 15:47:50 Tex-Tok]: [0mData (t): 0.0106, 36.55/s/gpu Batch (t): 0.4377 LR: 0.000029 Step: 2900 Total Loss: 1.7515 Recon Loss: 0.8989 
[32m[04/13 15:48:12 Tex-Tok]: [0mData (t): 0.0106, 36.22/s/gpu Batch (t): 0.4417 LR: 0.000029 Step: 2950 Total Loss: 1.7547 Recon Loss: 0.9918 
[32m[04/13 15:48:34 Tex-Tok]: [0mData (t): 0.0106, 32.71/s/gpu Batch (t): 0.4892 LR: 0.000030 Step: 3000 Total Loss: 2.0718 Recon Loss: 1.1972 
[32m[04/13 15:48:34 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:48:57 Tex-Tok]: [0mData (t): 0.0104, 36.32/s/gpu Batch (t): 0.4405 LR: 0.000030 Step: 3050 Total Loss: 2.1060 Recon Loss: 1.0350 
[32m[04/13 15:49:18 Tex-Tok]: [0mData (t): 0.0105, 36.55/s/gpu Batch (t): 0.4378 LR: 0.000031 Step: 3100 Total Loss: 1.7632 Recon Loss: 0.8491 
[32m[04/13 15:49:40 Tex-Tok]: [0mData (t): 0.0105, 36.55/s/gpu Batch (t): 0.4377 LR: 0.000031 Step: 3150 Total Loss: 2.0320 Recon Loss: 1.0009 
[32m[04/13 15:50:02 Tex-Tok]: [0mData (t): 0.0105, 36.60/s/gpu Batch (t): 0.4372 LR: 0.000032 Step: 3200 Total Loss: 1.7892 Recon Loss: 1.0515 
[32m[04/13 15:50:24 Tex-Tok]: [0mData (t): 0.0105, 36.55/s/gpu Batch (t): 0.4377 LR: 0.000032 Step: 3250 Total Loss: 1.7939 Recon Loss: 0.8560 
[32m[04/13 15:50:46 Tex-Tok]: [0mData (t): 0.0106, 36.50/s/gpu Batch (t): 0.4384 LR: 0.000033 Step: 3300 Total Loss: 2.0455 Recon Loss: 0.9334 
[32m[04/13 15:51:08 Tex-Tok]: [0mData (t): 0.0104, 36.66/s/gpu Batch (t): 0.4364 LR: 0.000033 Step: 3350 Total Loss: 2.0880 Recon Loss: 1.1554 
[32m[04/13 15:51:30 Tex-Tok]: [0mData (t): 0.0105, 36.38/s/gpu Batch (t): 0.4398 LR: 0.000034 Step: 3400 Total Loss: 1.6857 Recon Loss: 0.8841 
[32m[04/13 15:51:52 Tex-Tok]: [0mData (t): 0.0106, 36.44/s/gpu Batch (t): 0.4391 LR: 0.000034 Step: 3450 Total Loss: 1.9044 Recon Loss: 1.0169 
[32m[04/13 15:52:14 Tex-Tok]: [0mData (t): 0.0106, 36.54/s/gpu Batch (t): 0.4378 LR: 0.000035 Step: 3500 Total Loss: 2.0915 Recon Loss: 1.1676 
[32m[04/13 15:52:14 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:52:36 Tex-Tok]: [0mData (t): 0.0105, 36.66/s/gpu Batch (t): 0.4365 LR: 0.000035 Step: 3550 Total Loss: 1.9275 Recon Loss: 0.9357 
[32m[04/13 15:52:58 Tex-Tok]: [0mData (t): 0.0105, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000036 Step: 3600 Total Loss: 1.7668 Recon Loss: 0.9365 
[32m[04/13 15:53:20 Tex-Tok]: [0mData (t): 0.0106, 36.34/s/gpu Batch (t): 0.4403 LR: 0.000036 Step: 3650 Total Loss: 1.8970 Recon Loss: 0.9436 
[32m[04/13 15:53:42 Tex-Tok]: [0mData (t): 0.0105, 36.61/s/gpu Batch (t): 0.4370 LR: 0.000037 Step: 3700 Total Loss: 1.8405 Recon Loss: 1.0316 
[32m[04/13 15:54:04 Tex-Tok]: [0mData (t): 0.0106, 36.60/s/gpu Batch (t): 0.4371 LR: 0.000037 Step: 3750 Total Loss: 1.8206 Recon Loss: 1.0224 
[32m[04/13 15:54:26 Tex-Tok]: [0mData (t): 0.0104, 36.54/s/gpu Batch (t): 0.4378 LR: 0.000038 Step: 3800 Total Loss: 1.6983 Recon Loss: 1.0264 
[32m[04/13 15:54:48 Tex-Tok]: [0mData (t): 0.0105, 36.62/s/gpu Batch (t): 0.4369 LR: 0.000038 Step: 3850 Total Loss: 1.9348 Recon Loss: 1.0063 
[32m[04/13 15:55:10 Tex-Tok]: [0mData (t): 0.0105, 36.61/s/gpu Batch (t): 0.4370 LR: 0.000039 Step: 3900 Total Loss: 2.0761 Recon Loss: 1.0371 
[32m[04/13 15:55:31 Tex-Tok]: [0mData (t): 0.0106, 36.39/s/gpu Batch (t): 0.4397 LR: 0.000039 Step: 3950 Total Loss: 1.9554 Recon Loss: 1.0563 
[32m[04/13 15:55:53 Tex-Tok]: [0mData (t): 0.0105, 32.50/s/gpu Batch (t): 0.4923 LR: 0.000040 Step: 4000 Total Loss: 2.0903 Recon Loss: 1.0794 
[32m[04/13 15:55:54 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:56:16 Tex-Tok]: [0mData (t): 0.0105, 36.61/s/gpu Batch (t): 0.4370 LR: 0.000040 Step: 4050 Total Loss: 1.7445 Recon Loss: 0.9541 
[32m[04/13 15:56:38 Tex-Tok]: [0mData (t): 0.0105, 36.60/s/gpu Batch (t): 0.4372 LR: 0.000041 Step: 4100 Total Loss: 1.9216 Recon Loss: 1.1830 
[32m[04/13 15:57:00 Tex-Tok]: [0mData (t): 0.0105, 36.33/s/gpu Batch (t): 0.4404 LR: 0.000041 Step: 4150 Total Loss: 1.6987 Recon Loss: 0.9650 
[32m[04/13 15:57:22 Tex-Tok]: [0mData (t): 0.0105, 36.41/s/gpu Batch (t): 0.4394 LR: 0.000042 Step: 4200 Total Loss: 1.6655 Recon Loss: 0.9432 
[32m[04/13 15:57:44 Tex-Tok]: [0mData (t): 0.0105, 36.63/s/gpu Batch (t): 0.4368 LR: 0.000042 Step: 4250 Total Loss: 1.9568 Recon Loss: 1.0656 
[32m[04/13 15:58:06 Tex-Tok]: [0mData (t): 0.0105, 36.38/s/gpu Batch (t): 0.4398 LR: 0.000043 Step: 4300 Total Loss: 1.8655 Recon Loss: 1.1005 
[32m[04/13 15:58:28 Tex-Tok]: [0mData (t): 0.0105, 36.46/s/gpu Batch (t): 0.4389 LR: 0.000043 Step: 4350 Total Loss: 1.8119 Recon Loss: 0.9597 
[32m[04/13 15:58:50 Tex-Tok]: [0mData (t): 0.0104, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000044 Step: 4400 Total Loss: 1.7965 Recon Loss: 0.9329 
[32m[04/13 15:59:11 Tex-Tok]: [0mData (t): 0.0106, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000044 Step: 4450 Total Loss: 1.5840 Recon Loss: 0.9102 
[32m[04/13 15:59:33 Tex-Tok]: [0mData (t): 0.0105, 36.52/s/gpu Batch (t): 0.4381 LR: 0.000045 Step: 4500 Total Loss: 1.5705 Recon Loss: 0.8113 
[32m[04/13 15:59:34 Tex-Tok]: [0mReconstructing images...
[32m[04/13 15:59:56 Tex-Tok]: [0mData (t): 0.0106, 36.48/s/gpu Batch (t): 0.4386 LR: 0.000045 Step: 4550 Total Loss: 1.8129 Recon Loss: 1.1205 
[32m[04/13 16:00:18 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000046 Step: 4600 Total Loss: 1.7013 Recon Loss: 0.9874 
[32m[04/13 16:00:40 Tex-Tok]: [0mData (t): 0.0106, 36.58/s/gpu Batch (t): 0.4373 LR: 0.000046 Step: 4650 Total Loss: 1.7693 Recon Loss: 1.0981 
[32m[04/13 16:01:01 Tex-Tok]: [0mData (t): 0.0105, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000047 Step: 4700 Total Loss: 1.6874 Recon Loss: 0.9697 
[32m[04/13 16:01:23 Tex-Tok]: [0mData (t): 0.0105, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000047 Step: 4750 Total Loss: 1.5381 Recon Loss: 0.8464 
[32m[04/13 16:01:45 Tex-Tok]: [0mData (t): 0.0105, 36.48/s/gpu Batch (t): 0.4386 LR: 0.000048 Step: 4800 Total Loss: 1.6196 Recon Loss: 0.9095 
[32m[04/13 16:02:07 Tex-Tok]: [0mData (t): 0.0106, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000048 Step: 4850 Total Loss: 1.9609 Recon Loss: 1.2307 
[32m[04/13 16:02:29 Tex-Tok]: [0mData (t): 0.0115, 36.52/s/gpu Batch (t): 0.4381 LR: 0.000049 Step: 4900 Total Loss: 1.8168 Recon Loss: 1.0942 
[32m[04/13 16:02:51 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000049 Step: 4950 Total Loss: 1.8619 Recon Loss: 1.0172 
[32m[04/13 16:03:13 Tex-Tok]: [0mData (t): 0.0104, 34.80/s/gpu Batch (t): 0.4598 LR: 0.000050 Step: 5000 Total Loss: 1.9952 Recon Loss: 1.1753 
[32m[04/13 16:03:13 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:03:35 Tex-Tok]: [0mData (t): 0.0105, 36.60/s/gpu Batch (t): 0.4371 LR: 0.000050 Step: 5050 Total Loss: 1.6428 Recon Loss: 0.8640 
[32m[04/13 16:03:57 Tex-Tok]: [0mData (t): 0.0104, 36.31/s/gpu Batch (t): 0.4406 LR: 0.000051 Step: 5100 Total Loss: 1.5913 Recon Loss: 0.9332 
[32m[04/13 16:04:19 Tex-Tok]: [0mData (t): 0.0106, 36.28/s/gpu Batch (t): 0.4410 LR: 0.000051 Step: 5150 Total Loss: 1.6822 Recon Loss: 1.0119 
[32m[04/13 16:04:41 Tex-Tok]: [0mData (t): 0.0105, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000052 Step: 5200 Total Loss: 1.5010 Recon Loss: 0.7774 
[32m[04/13 16:05:03 Tex-Tok]: [0mData (t): 0.0106, 36.44/s/gpu Batch (t): 0.4391 LR: 0.000052 Step: 5250 Total Loss: 1.8047 Recon Loss: 0.9101 
[32m[04/13 16:05:25 Tex-Tok]: [0mData (t): 0.0105, 36.29/s/gpu Batch (t): 0.4409 LR: 0.000053 Step: 5300 Total Loss: 2.0901 Recon Loss: 1.1037 
[32m[04/13 16:05:47 Tex-Tok]: [0mData (t): 0.0106, 36.60/s/gpu Batch (t): 0.4372 LR: 0.000053 Step: 5350 Total Loss: 1.5509 Recon Loss: 0.8547 
[32m[04/13 16:06:09 Tex-Tok]: [0mData (t): 0.0105, 36.41/s/gpu Batch (t): 0.4395 LR: 0.000054 Step: 5400 Total Loss: 1.6603 Recon Loss: 0.9740 
[32m[04/13 16:06:31 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000054 Step: 5450 Total Loss: 1.6605 Recon Loss: 0.9796 
[32m[04/13 16:06:53 Tex-Tok]: [0mData (t): 0.0106, 36.62/s/gpu Batch (t): 0.4369 LR: 0.000055 Step: 5500 Total Loss: 1.7730 Recon Loss: 0.9935 
[32m[04/13 16:06:53 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:07:15 Tex-Tok]: [0mData (t): 0.0105, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000055 Step: 5550 Total Loss: 1.7927 Recon Loss: 1.0010 
[32m[04/13 16:07:37 Tex-Tok]: [0mData (t): 0.0107, 36.44/s/gpu Batch (t): 0.4390 LR: 0.000056 Step: 5600 Total Loss: 1.6189 Recon Loss: 0.9066 
[32m[04/13 16:07:59 Tex-Tok]: [0mData (t): 0.0105, 36.52/s/gpu Batch (t): 0.4382 LR: 0.000056 Step: 5650 Total Loss: 1.7254 Recon Loss: 0.9787 
[32m[04/13 16:08:21 Tex-Tok]: [0mData (t): 0.0105, 36.55/s/gpu Batch (t): 0.4378 LR: 0.000057 Step: 5700 Total Loss: 1.5988 Recon Loss: 0.7565 
[32m[04/13 16:08:43 Tex-Tok]: [0mData (t): 0.0105, 36.64/s/gpu Batch (t): 0.4367 LR: 0.000057 Step: 5750 Total Loss: 1.7148 Recon Loss: 0.9553 
[32m[04/13 16:09:05 Tex-Tok]: [0mData (t): 0.0108, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000058 Step: 5800 Total Loss: 1.5910 Recon Loss: 0.9301 
[32m[04/13 16:09:27 Tex-Tok]: [0mData (t): 0.0107, 36.16/s/gpu Batch (t): 0.4425 LR: 0.000058 Step: 5850 Total Loss: 1.5339 Recon Loss: 0.8443 
[32m[04/13 16:09:48 Tex-Tok]: [0mData (t): 0.0105, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000059 Step: 5900 Total Loss: 1.6540 Recon Loss: 0.9350 
[32m[04/13 16:10:10 Tex-Tok]: [0mData (t): 0.0105, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000059 Step: 5950 Total Loss: 1.8222 Recon Loss: 0.8206 
[32m[04/13 16:10:32 Tex-Tok]: [0mData (t): 0.0105, 30.51/s/gpu Batch (t): 0.5245 LR: 0.000060 Step: 6000 Total Loss: 1.6287 Recon Loss: 0.9441 
[32m[04/13 16:10:33 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:10:55 Tex-Tok]: [0mData (t): 0.0105, 36.62/s/gpu Batch (t): 0.4370 LR: 0.000060 Step: 6050 Total Loss: 1.4479 Recon Loss: 0.6766 
[32m[04/13 16:11:17 Tex-Tok]: [0mData (t): 0.0105, 35.85/s/gpu Batch (t): 0.4463 LR: 0.000061 Step: 6100 Total Loss: 1.4928 Recon Loss: 0.7893 
[32m[04/13 16:11:39 Tex-Tok]: [0mData (t): 0.0105, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000061 Step: 6150 Total Loss: 1.6042 Recon Loss: 0.8869 
[32m[04/13 16:12:01 Tex-Tok]: [0mData (t): 0.0105, 36.46/s/gpu Batch (t): 0.4388 LR: 0.000062 Step: 6200 Total Loss: 1.6961 Recon Loss: 0.9358 
[32m[04/13 16:12:23 Tex-Tok]: [0mData (t): 0.0106, 36.51/s/gpu Batch (t): 0.4382 LR: 0.000062 Step: 6250 Total Loss: 1.5776 Recon Loss: 0.8566 
[32m[04/13 16:12:44 Tex-Tok]: [0mData (t): 0.0110, 36.61/s/gpu Batch (t): 0.4370 LR: 0.000063 Step: 6300 Total Loss: 1.4988 Recon Loss: 0.8412 
[32m[04/13 16:13:06 Tex-Tok]: [0mData (t): 0.0108, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000063 Step: 6350 Total Loss: 1.5066 Recon Loss: 0.8283 
[32m[04/13 16:13:28 Tex-Tok]: [0mData (t): 0.0105, 36.54/s/gpu Batch (t): 0.4379 LR: 0.000064 Step: 6400 Total Loss: 1.5585 Recon Loss: 0.8796 
[32m[04/13 16:13:50 Tex-Tok]: [0mData (t): 0.0105, 36.60/s/gpu Batch (t): 0.4371 LR: 0.000064 Step: 6450 Total Loss: 1.7251 Recon Loss: 0.9282 
[32m[04/13 16:14:12 Tex-Tok]: [0mData (t): 0.0106, 36.63/s/gpu Batch (t): 0.4368 LR: 0.000065 Step: 6500 Total Loss: 1.5364 Recon Loss: 0.8290 
[32m[04/13 16:14:13 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:14:35 Tex-Tok]: [0mData (t): 0.0115, 36.54/s/gpu Batch (t): 0.4379 LR: 0.000065 Step: 6550 Total Loss: 1.5862 Recon Loss: 0.8833 
[32m[04/13 16:14:57 Tex-Tok]: [0mData (t): 0.0105, 36.60/s/gpu Batch (t): 0.4372 LR: 0.000066 Step: 6600 Total Loss: 1.4857 Recon Loss: 0.8320 
[32m[04/13 16:15:18 Tex-Tok]: [0mData (t): 0.0106, 36.50/s/gpu Batch (t): 0.4383 LR: 0.000066 Step: 6650 Total Loss: 1.5635 Recon Loss: 0.8986 
[32m[04/13 16:15:40 Tex-Tok]: [0mData (t): 0.0105, 36.63/s/gpu Batch (t): 0.4368 LR: 0.000067 Step: 6700 Total Loss: 1.4894 Recon Loss: 0.7806 
[32m[04/13 16:16:02 Tex-Tok]: [0mData (t): 0.0106, 36.48/s/gpu Batch (t): 0.4385 LR: 0.000067 Step: 6750 Total Loss: 1.4614 Recon Loss: 0.8157 
[32m[04/13 16:16:24 Tex-Tok]: [0mData (t): 0.0105, 36.46/s/gpu Batch (t): 0.4388 LR: 0.000068 Step: 6800 Total Loss: 1.7103 Recon Loss: 0.9238 
[32m[04/13 16:16:46 Tex-Tok]: [0mData (t): 0.0106, 36.54/s/gpu Batch (t): 0.4379 LR: 0.000068 Step: 6850 Total Loss: 1.6631 Recon Loss: 0.9899 
[32m[04/13 16:17:08 Tex-Tok]: [0mData (t): 0.0105, 36.41/s/gpu Batch (t): 0.4394 LR: 0.000069 Step: 6900 Total Loss: 1.5237 Recon Loss: 0.7537 
[32m[04/13 16:17:30 Tex-Tok]: [0mData (t): 0.0105, 36.50/s/gpu Batch (t): 0.4383 LR: 0.000069 Step: 6950 Total Loss: 1.7100 Recon Loss: 0.8941 
[32m[04/13 16:17:52 Tex-Tok]: [0mData (t): 0.0105, 34.72/s/gpu Batch (t): 0.4609 LR: 0.000070 Step: 7000 Total Loss: 1.5564 Recon Loss: 0.8724 
[32m[04/13 16:17:52 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:18:14 Tex-Tok]: [0mData (t): 0.0105, 36.42/s/gpu Batch (t): 0.4393 LR: 0.000070 Step: 7050 Total Loss: 1.5340 Recon Loss: 0.8438 
[32m[04/13 16:18:36 Tex-Tok]: [0mData (t): 0.0105, 36.45/s/gpu Batch (t): 0.4390 LR: 0.000071 Step: 7100 Total Loss: 1.5863 Recon Loss: 0.9126 
[32m[04/13 16:18:58 Tex-Tok]: [0mData (t): 0.0105, 36.50/s/gpu Batch (t): 0.4383 LR: 0.000071 Step: 7150 Total Loss: 1.3981 Recon Loss: 0.7328 
[32m[04/13 16:19:20 Tex-Tok]: [0mData (t): 0.0106, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000072 Step: 7200 Total Loss: 1.5364 Recon Loss: 0.8015 
[32m[04/13 16:19:42 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000072 Step: 7250 Total Loss: 1.5299 Recon Loss: 0.8385 
[32m[04/13 16:20:04 Tex-Tok]: [0mData (t): 0.0105, 36.60/s/gpu Batch (t): 0.4371 LR: 0.000073 Step: 7300 Total Loss: 1.4193 Recon Loss: 0.7239 
[32m[04/13 16:20:26 Tex-Tok]: [0mData (t): 0.0105, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000073 Step: 7350 Total Loss: 1.4670 Recon Loss: 0.8024 
[32m[04/13 16:20:48 Tex-Tok]: [0mData (t): 0.0105, 36.47/s/gpu Batch (t): 0.4387 LR: 0.000074 Step: 7400 Total Loss: 1.7628 Recon Loss: 0.8818 
[32m[04/13 16:21:10 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000074 Step: 7450 Total Loss: 1.6935 Recon Loss: 0.9853 
[32m[04/13 16:21:31 Tex-Tok]: [0mData (t): 0.0105, 36.59/s/gpu Batch (t): 0.4373 LR: 0.000075 Step: 7500 Total Loss: 1.5208 Recon Loss: 0.7890 
[32m[04/13 16:21:32 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:21:54 Tex-Tok]: [0mData (t): 0.0106, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000075 Step: 7550 Total Loss: 1.4603 Recon Loss: 0.7476 
[32m[04/13 16:22:16 Tex-Tok]: [0mData (t): 0.0105, 36.33/s/gpu Batch (t): 0.4404 LR: 0.000076 Step: 7600 Total Loss: 1.5803 Recon Loss: 0.7924 
[32m[04/13 16:22:38 Tex-Tok]: [0mData (t): 0.0105, 36.56/s/gpu Batch (t): 0.4376 LR: 0.000076 Step: 7650 Total Loss: 1.6197 Recon Loss: 0.9484 
[32m[04/13 16:23:00 Tex-Tok]: [0mData (t): 0.0105, 36.53/s/gpu Batch (t): 0.4380 LR: 0.000077 Step: 7700 Total Loss: 1.6969 Recon Loss: 0.8573 
[32m[04/13 16:23:22 Tex-Tok]: [0mData (t): 0.0105, 36.26/s/gpu Batch (t): 0.4412 LR: 0.000077 Step: 7750 Total Loss: 1.4935 Recon Loss: 0.8292 
[32m[04/13 16:23:44 Tex-Tok]: [0mData (t): 0.0105, 36.59/s/gpu Batch (t): 0.4372 LR: 0.000078 Step: 7800 Total Loss: 1.4908 Recon Loss: 0.7848 
[32m[04/13 16:24:05 Tex-Tok]: [0mData (t): 0.0105, 36.62/s/gpu Batch (t): 0.4369 LR: 0.000078 Step: 7850 Total Loss: 1.6700 Recon Loss: 0.8812 
[32m[04/13 16:24:27 Tex-Tok]: [0mData (t): 0.0105, 36.52/s/gpu Batch (t): 0.4381 LR: 0.000079 Step: 7900 Total Loss: 1.6222 Recon Loss: 0.9290 
[32m[04/13 16:24:49 Tex-Tok]: [0mData (t): 0.0105, 36.22/s/gpu Batch (t): 0.4417 LR: 0.000079 Step: 7950 Total Loss: 1.6131 Recon Loss: 0.9396 
[32m[04/13 16:25:11 Tex-Tok]: [0mData (t): 0.0106, 34.68/s/gpu Batch (t): 0.4614 LR: 0.000080 Step: 8000 Total Loss: 1.4708 Recon Loss: 0.8005 
[32m[04/13 16:25:12 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:25:34 Tex-Tok]: [0mData (t): 0.0106, 36.26/s/gpu Batch (t): 0.4412 LR: 0.000080 Step: 8050 Total Loss: 1.5077 Recon Loss: 0.8465 
[32m[04/13 16:25:56 Tex-Tok]: [0mData (t): 0.0105, 36.35/s/gpu Batch (t): 0.4401 LR: 0.000081 Step: 8100 Total Loss: 1.5838 Recon Loss: 0.8457 
[32m[04/13 16:26:17 Tex-Tok]: [0mData (t): 0.0106, 36.57/s/gpu Batch (t): 0.4375 LR: 0.000081 Step: 8150 Total Loss: 1.5120 Recon Loss: 0.7447 
[32m[04/13 16:26:39 Tex-Tok]: [0mData (t): 0.0106, 36.43/s/gpu Batch (t): 0.4392 LR: 0.000082 Step: 8200 Total Loss: 1.5455 Recon Loss: 0.7951 
[32m[04/13 16:27:01 Tex-Tok]: [0mData (t): 0.0105, 36.49/s/gpu Batch (t): 0.4385 LR: 0.000082 Step: 8250 Total Loss: 1.6418 Recon Loss: 0.9587 
[32m[04/13 16:27:23 Tex-Tok]: [0mData (t): 0.0105, 36.39/s/gpu Batch (t): 0.4397 LR: 0.000083 Step: 8300 Total Loss: 1.5487 Recon Loss: 0.7434 
[32m[04/13 16:27:45 Tex-Tok]: [0mData (t): 0.0105, 36.58/s/gpu Batch (t): 0.4374 LR: 0.000083 Step: 8350 Total Loss: 1.5657 Recon Loss: 0.8373 
[32m[04/13 16:28:07 Tex-Tok]: [0mData (t): 0.0107, 36.26/s/gpu Batch (t): 0.4413 LR: 0.000084 Step: 8400 Total Loss: 1.7878 Recon Loss: 1.0326 
[32m[04/13 16:28:32 Tex-Tok]: [0mData (t): 0.0117, 32.51/s/gpu Batch (t): 0.4922 LR: 0.000084 Step: 8450 Total Loss: 1.3860 Recon Loss: 0.7512 
[32m[04/13 16:28:58 Tex-Tok]: [0mData (t): 0.0111, 30.14/s/gpu Batch (t): 0.5308 LR: 0.000085 Step: 8500 Total Loss: 1.6380 Recon Loss: 0.9361 
[32m[04/13 16:28:59 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:29:25 Tex-Tok]: [0mData (t): 0.0119, 32.45/s/gpu Batch (t): 0.4931 LR: 0.000085 Step: 8550 Total Loss: 1.4849 Recon Loss: 0.8029 
[32m[04/13 16:29:50 Tex-Tok]: [0mData (t): 0.0115, 31.98/s/gpu Batch (t): 0.5003 LR: 0.000086 Step: 8600 Total Loss: 1.6842 Recon Loss: 0.9102 
[32m[04/13 16:30:15 Tex-Tok]: [0mData (t): 0.0114, 31.16/s/gpu Batch (t): 0.5136 LR: 0.000086 Step: 8650 Total Loss: 1.5501 Recon Loss: 0.7724 
[32m[04/13 16:30:41 Tex-Tok]: [0mData (t): 0.0139, 29.72/s/gpu Batch (t): 0.5383 LR: 0.000087 Step: 8700 Total Loss: 1.4651 Recon Loss: 0.7837 
[32m[04/13 16:31:06 Tex-Tok]: [0mData (t): 0.0126, 32.20/s/gpu Batch (t): 0.4969 LR: 0.000087 Step: 8750 Total Loss: 1.4250 Recon Loss: 0.7014 
[32m[04/13 16:31:31 Tex-Tok]: [0mData (t): 0.0115, 31.98/s/gpu Batch (t): 0.5004 LR: 0.000088 Step: 8800 Total Loss: 1.3450 Recon Loss: 0.6829 
[32m[04/13 16:31:57 Tex-Tok]: [0mData (t): 0.0115, 32.27/s/gpu Batch (t): 0.4959 LR: 0.000088 Step: 8850 Total Loss: 1.4508 Recon Loss: 0.7445 
[32m[04/13 16:32:22 Tex-Tok]: [0mData (t): 0.0153, 29.71/s/gpu Batch (t): 0.5385 LR: 0.000089 Step: 8900 Total Loss: 1.4723 Recon Loss: 0.7912 
[32m[04/13 16:32:47 Tex-Tok]: [0mData (t): 0.0116, 31.36/s/gpu Batch (t): 0.5103 LR: 0.000089 Step: 8950 Total Loss: 1.6951 Recon Loss: 0.8799 
[32m[04/13 16:33:13 Tex-Tok]: [0mData (t): 0.0128, 30.13/s/gpu Batch (t): 0.5311 LR: 0.000090 Step: 9000 Total Loss: 1.2952 Recon Loss: 0.6266 
[32m[04/13 16:33:14 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:33:39 Tex-Tok]: [0mData (t): 0.0122, 32.10/s/gpu Batch (t): 0.4984 LR: 0.000090 Step: 9050 Total Loss: 1.5420 Recon Loss: 0.7631 
[32m[04/13 16:34:03 Tex-Tok]: [0mData (t): 0.0126, 30.96/s/gpu Batch (t): 0.5169 LR: 0.000091 Step: 9100 Total Loss: 1.6843 Recon Loss: 0.8263 
[32m[04/13 16:34:28 Tex-Tok]: [0mData (t): 0.0107, 32.55/s/gpu Batch (t): 0.4915 LR: 0.000091 Step: 9150 Total Loss: 1.5819 Recon Loss: 0.8232 
[32m[04/13 16:34:53 Tex-Tok]: [0mData (t): 0.0121, 31.90/s/gpu Batch (t): 0.5015 LR: 0.000092 Step: 9200 Total Loss: 1.7346 Recon Loss: 0.8063 
[32m[04/13 16:35:19 Tex-Tok]: [0mData (t): 0.0107, 32.52/s/gpu Batch (t): 0.4920 LR: 0.000092 Step: 9250 Total Loss: 1.6215 Recon Loss: 0.8130 
[32m[04/13 16:35:44 Tex-Tok]: [0mData (t): 0.0118, 30.61/s/gpu Batch (t): 0.5227 LR: 0.000093 Step: 9300 Total Loss: 1.5916 Recon Loss: 0.7615 
[32m[04/13 16:36:09 Tex-Tok]: [0mData (t): 0.0119, 32.29/s/gpu Batch (t): 0.4955 LR: 0.000093 Step: 9350 Total Loss: 1.5130 Recon Loss: 0.7681 
[32m[04/13 16:36:34 Tex-Tok]: [0mData (t): 0.0107, 30.59/s/gpu Batch (t): 0.5230 LR: 0.000094 Step: 9400 Total Loss: 1.4942 Recon Loss: 0.7070 
[32m[04/13 16:36:59 Tex-Tok]: [0mData (t): 0.0132, 32.46/s/gpu Batch (t): 0.4929 LR: 0.000094 Step: 9450 Total Loss: 1.6058 Recon Loss: 0.8272 
[32m[04/13 16:37:24 Tex-Tok]: [0mData (t): 0.0123, 31.38/s/gpu Batch (t): 0.5099 LR: 0.000095 Step: 9500 Total Loss: 1.5562 Recon Loss: 0.8215 
[32m[04/13 16:37:25 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:37:50 Tex-Tok]: [0mData (t): 0.0125, 30.20/s/gpu Batch (t): 0.5298 LR: 0.000095 Step: 9550 Total Loss: 1.7458 Recon Loss: 0.8288 
[32m[04/13 16:38:16 Tex-Tok]: [0mData (t): 0.0122, 32.04/s/gpu Batch (t): 0.4994 LR: 0.000096 Step: 9600 Total Loss: 1.3891 Recon Loss: 0.6299 
[32m[04/13 16:38:41 Tex-Tok]: [0mData (t): 0.0109, 32.06/s/gpu Batch (t): 0.4990 LR: 0.000096 Step: 9650 Total Loss: 1.4457 Recon Loss: 0.6493 
[32m[04/13 16:39:06 Tex-Tok]: [0mData (t): 0.0109, 32.19/s/gpu Batch (t): 0.4970 LR: 0.000097 Step: 9700 Total Loss: 1.5455 Recon Loss: 0.7719 
[32m[04/13 16:39:31 Tex-Tok]: [0mData (t): 0.0126, 32.28/s/gpu Batch (t): 0.4956 LR: 0.000097 Step: 9750 Total Loss: 1.3952 Recon Loss: 0.6847 
[32m[04/13 16:39:56 Tex-Tok]: [0mData (t): 0.0134, 30.53/s/gpu Batch (t): 0.5240 LR: 0.000098 Step: 9800 Total Loss: 1.5011 Recon Loss: 0.7283 
[32m[04/13 16:40:21 Tex-Tok]: [0mData (t): 0.0110, 32.28/s/gpu Batch (t): 0.4957 LR: 0.000098 Step: 9850 Total Loss: 1.3946 Recon Loss: 0.5932 
[32m[04/13 16:40:46 Tex-Tok]: [0mData (t): 0.0118, 32.04/s/gpu Batch (t): 0.4994 LR: 0.000099 Step: 9900 Total Loss: 1.4071 Recon Loss: 0.6352 
[32m[04/13 16:41:12 Tex-Tok]: [0mData (t): 0.0120, 32.24/s/gpu Batch (t): 0.4963 LR: 0.000099 Step: 9950 Total Loss: 1.5168 Recon Loss: 0.7829 
[32m[04/13 16:41:37 Tex-Tok]: [0mData (t): 0.0305, 27.62/s/gpu Batch (t): 0.5792 LR: 0.000100 Step: 10000 Total Loss: 1.4708 Recon Loss: 0.5993 
[32m[04/13 16:41:38 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:42:04 Tex-Tok]: [0mData (t): 0.0113, 30.81/s/gpu Batch (t): 0.5192 LR: 0.000100 Step: 10050 Total Loss: 1.4582 Recon Loss: 0.6747 
[32m[04/13 16:42:29 Tex-Tok]: [0mData (t): 0.0125, 30.46/s/gpu Batch (t): 0.5253 LR: 0.000100 Step: 10100 Total Loss: 1.4589 Recon Loss: 0.7572 
[32m[04/13 16:42:55 Tex-Tok]: [0mData (t): 0.0125, 32.37/s/gpu Batch (t): 0.4944 LR: 0.000100 Step: 10150 Total Loss: 1.5288 Recon Loss: 0.6550 
[32m[04/13 16:43:20 Tex-Tok]: [0mData (t): 0.0120, 32.13/s/gpu Batch (t): 0.4980 LR: 0.000100 Step: 10200 Total Loss: 1.4957 Recon Loss: 0.7296 
[32m[04/13 16:43:45 Tex-Tok]: [0mData (t): 0.0143, 31.82/s/gpu Batch (t): 0.5028 LR: 0.000100 Step: 10250 Total Loss: 1.3386 Recon Loss: 0.6319 
[32m[04/13 16:44:11 Tex-Tok]: [0mData (t): 0.0124, 31.96/s/gpu Batch (t): 0.5006 LR: 0.000100 Step: 10300 Total Loss: 1.3817 Recon Loss: 0.6271 
[32m[04/13 16:44:36 Tex-Tok]: [0mData (t): 0.0142, 32.03/s/gpu Batch (t): 0.4995 LR: 0.000100 Step: 10350 Total Loss: 1.3635 Recon Loss: 0.6452 
[32m[04/13 16:45:02 Tex-Tok]: [0mData (t): 0.0118, 30.74/s/gpu Batch (t): 0.5206 LR: 0.000100 Step: 10400 Total Loss: 1.4675 Recon Loss: 0.6960 
[32m[04/13 16:45:27 Tex-Tok]: [0mData (t): 0.0116, 31.56/s/gpu Batch (t): 0.5070 LR: 0.000100 Step: 10450 Total Loss: 1.4459 Recon Loss: 0.6577 
[32m[04/13 16:45:52 Tex-Tok]: [0mData (t): 0.0127, 31.91/s/gpu Batch (t): 0.5014 LR: 0.000100 Step: 10500 Total Loss: 1.3864 Recon Loss: 0.6503 
[32m[04/13 16:45:52 Tex-Tok]: [0mReconstructing images...
[32m[04/13 16:46:18 Tex-Tok]: [0mData (t): 0.0140, 32.11/s/gpu Batch (t): 0.4983 LR: 0.000100 Step: 10550 Total Loss: 1.3239 Recon Loss: 0.6424 
[32m[04/13 16:46:43 Tex-Tok]: [0mData (t): 0.0115, 30.96/s/gpu Batch (t): 0.5167 LR: 0.000100 Step: 10600 Total Loss: 1.4348 Recon Loss: 0.6503 
[32m[04/13 16:47:08 Tex-Tok]: [0mData (t): 0.0113, 32.50/s/gpu Batch (t): 0.4923 LR: 0.000100 Step: 10650 Total Loss: 1.3007 Recon Loss: 0.5447 
[32m[04/13 16:47:34 Tex-Tok]: [0mData (t): 0.0126, 31.14/s/gpu Batch (t): 0.5138 LR: 0.000100 Step: 10700 Total Loss: 1.3025 Recon Loss: 0.5967 
[32m[04/13 16:47:59 Tex-Tok]: [0mData (t): 0.0113, 32.67/s/gpu Batch (t): 0.4897 LR: 0.000100 Step: 10750 Total Loss: 1.3331 Recon Loss: 0.6189 
